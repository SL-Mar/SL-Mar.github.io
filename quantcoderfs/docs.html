<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuantCoderFS v2.0.1 Documentation - Technical Reference</title>
    <link rel="stylesheet" href="assets/css/docs.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Documentation Header -->
    <header class="docs-header">
        <div class="docs-header-content">
            <a href="docs.html" class="docs-logo">
                <i class="fas fa-chart-line"></i>
                <span>QuantCoderFS</span>
            </a>
            <nav>
                <ul class="docs-nav">
                    <li><a href="docs.html" class="active">Documentation</a></li>
                    <li><a href="https://quantcoder-fs.com" target="_blank"><i class="fas fa-globe"></i> Website</a></li>
                </ul>
            </nav>
            <a href="../index.html" class="back-to-main"><i class="fas fa-arrow-left"></i> Back to Main Site</a>
        </div>
    </header>

    <!-- Documentation Container -->
    <div class="docs-container">
        <!-- Left Sidebar Navigation -->
        <aside class="docs-sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Getting Started</div>
                <ul class="sidebar-menu">
                    <li><a href="#overview"><i class="fas fa-home"></i> Overview</a></li>
                    <li><a href="#architecture"><i class="fas fa-sitemap"></i> Architecture</a></li>
                    <li><a href="#installation"><i class="fas fa-download"></i> Installation</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">System Components</div>
                <ul class="sidebar-menu">
                    <li><a href="#market-intelligence"><i class="fas fa-chart-bar"></i> Market Intelligence</a></li>
                    <li><a href="#strategy-generator"><i class="fas fa-code"></i> Strategy Generator</a></li>
                    <li><a href="#dependencies"><i class="fas fa-cubes"></i> Dependencies</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">API Reference</div>
                <ul class="sidebar-menu">
                    <li><a href="#api-overview"><i class="fas fa-book"></i> API Overview</a></li>
                    <li><a href="api/stocks.html"><i class="fas fa-database"></i> Stocks API</a></li>
                    <li><a href="api/signals.html"><i class="fas fa-lightbulb"></i> Signals API</a></li>
                    <li><a href="api/settings.html"><i class="fas fa-cog"></i> Settings API</a></li>
                    <li><a href="api/research.html"><i class="fas fa-microscope"></i> Research API</a></li>
                    <li><a href="#api-strategies"><i class="fas fa-file-code"></i> Strategies API</a></li>
                    <li><a href="#api-backtest"><i class="fas fa-rocket"></i> Backtest API</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Advanced Topics</div>
                <ul class="sidebar-menu">
                    <li><a href="#agents"><i class="fas fa-robot"></i> Agentic Frameworks</a></li>
                    <li><a href="#llm-providers"><i class="fas fa-brain"></i> LLM Providers</a></li>
                    <li><a href="#database"><i class="fas fa-table"></i> Database Schema</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Resources</div>
                <ul class="sidebar-menu">
                    <li><a href="https://quantcoderfs.substack.com" target="_blank"><i class="fas fa-newspaper"></i> Subscribe (Substack)</a></li>
                    <li><a href="https://arxiv.org/abs/2401.03737" target="_blank"><i class="fas fa-file-pdf"></i> MarketSense AI Paper</a></li>
                    <li><a href="https://www.quantconnect.com/docs" target="_blank"><i class="fas fa-book"></i> QuantConnect Docs</a></li>
                    <li><a href="contact.html"><i class="fas fa-envelope"></i> Contact</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="docs-main">
            <div class="docs-content">

                <!-- OVERVIEW SECTION -->
                <section id="overview">
                    <h1>QuantCoderFS v2.0.1 Technical Documentation</h1>
                    <p class="docs-subtitle">Complete reference for quantitative research and algorithm development platform</p>

                    <div class="info-box info-box-note">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Version Information
                        </div>
                        <p><strong>Version:</strong> 2.0.1 | <strong>Status:</strong> Active Development | <strong>Updated:</strong> October 16, 2025</p>
                    </div>

                    <h2>What is QuantCoderFS?</h2>
                    <p>QuantCoderFS is a unified quantitative research platform that combines two distinct modules:</p>

                    <h3>1. Market Intelligence Module</h3>
                    <ul>
                        <li><strong>Purpose:</strong> Multi-agent equity research inspired by <a href="https://arxiv.org/abs/2401.03737" target="_blank">MarketSense AI</a> (Fatouros et al., 2024)</li>
                        <li><strong>Input:</strong> Stock tickers (e.g., AAPL.US, TSLA.US)</li>
                        <li><strong>Output:</strong> BUY/HOLD/SELL trading signals with conviction scores (1-10)</li>
                        <li><strong>Technology:</strong> Custom multi-agent system with 4 specialized agents + 1 orchestrator</li>
                    </ul>

                    <h3>2. Strategy Generator Module</h3>
                    <ul>
                        <li><strong>Purpose:</strong> Automated trading algorithm generation from academic research papers</li>
                        <li><strong>Input:</strong> PDF research papers</li>
                        <li><strong>Output:</strong> Production-ready QuantConnect algorithm code (Python)</li>
                        <li><strong>Technology:</strong> CrewAI multi-agent workflow with PDF extraction and code generation</li>
                    </ul>

                    <h3>Core Technology Stack</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Layer</th>
                                <th>Technology</th>
                                <th>Version</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Backend Framework</td>
                                <td>FastAPI</td>
                                <td>0.115.12</td>
                            </tr>
                            <tr>
                                <td>Frontend Framework</td>
                                <td>Next.js (React 19)</td>
                                <td>15.3.2</td>
                            </tr>
                            <tr>
                                <td>Database</td>
                                <td>SQLite / PostgreSQL</td>
                                <td>SQLAlchemy 2.0.41</td>
                            </tr>
                            <tr>
                                <td>AI Framework (Strategies)</td>
                                <td>CrewAI</td>
                                <td>Latest</td>
                            </tr>
                            <tr>
                                <td>AI Framework (Signals)</td>
                                <td>Custom Multi-Agent</td>
                                <td>Inspired by MarketSense AI</td>
                            </tr>
                            <tr>
                                <td>Code Editor</td>
                                <td>Monaco Editor</td>
                                <td>4.7.0</td>
                            </tr>
                            <tr>
                                <td>Charts</td>
                                <td>Lightweight Charts</td>
                                <td>4.2.3</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- ARCHITECTURE SECTION -->
                <section id="architecture">
                    <h2>System Architecture</h2>

                    <h3>High-Level Architecture</h3>
                    <pre><code>┌─────────────────────────────────────────────────────────────┐
│                    Frontend (Next.js 15)                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │   Stocks     │  │  Strategies  │  │   Settings   │     │
│  │ (Research)   │  │ (Code Gen)   │  │              │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└──────────────────────────┬──────────────────────────────────┘
                           │ HTTP/REST API
┌──────────────────────────┴──────────────────────────────────┐
│                Backend (FastAPI + Python)                    │
│  ┌─────────────────────┐    ┌─────────────────────┐        │
│  │ Market Intelligence │    │ Strategy Generator  │        │
│  │ • Stock Handler     │    │ • PDF Extraction    │        │
│  │ • Signal Agents     │    │ • Code Generation   │        │
│  │ • Data Aggregation  │    │ • QC Integration    │        │
│  └─────────────────────┘    └─────────────────────┘        │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │              SQLite/PostgreSQL Database              │  │
│  └──────────────────────────────────────────────────────┘  │
└──────────────────────────┬──────────────────────────────────┘
                           │
        ┌──────────────────┼──────────────────┐
        │                  │                  │
   ┌────▼─────┐    ┌──────▼──────┐   ┌──────▼──────────┐
   │ EODHD    │    │  OpenAI/    │   │  QuantConnect  │
   │   API    │    │  Anthropic  │   │   REST API     │
   └──────────┘    └─────────────┘   └────────────────┘</code></pre>

                    <h3>Module Structure</h3>
                    <p><strong>Backend Directory Structure:</strong></p>
                    <pre><code>backend/
├── market_intelligence/          # Market Intelligence Module
│   ├── agents/                   # Multi-agent system (5 agents)
│   ├── api/routers/              # REST API endpoints
│   ├── core/                     # Business logic
│   └── db/                       # Database models & migrations
├── strategy_generator/           # Strategy Generator Module
│   ├── agents/                   # CrewAI agents
│   ├── routers/                  # REST API endpoints
│   └── tools/                    # CrewAI tools
├── shared/                       # Shared utilities
└── main.py                       # FastAPI app entry point</code></pre>
                </section>

                <!-- DEPENDENCIES SECTION -->
                <section id="dependencies">
                    <h2>Dependencies & Third-Party Services</h2>

                    <h3>Backend Dependencies</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Package</th>
                                <th>Version</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>fastapi</td>
                                <td>0.115.12</td>
                                <td>REST API framework</td>
                            </tr>
                            <tr>
                                <td>uvicorn</td>
                                <td>0.34.2</td>
                                <td>ASGI server</td>
                            </tr>
                            <tr>
                                <td>sqlalchemy</td>
                                <td>2.0.41</td>
                                <td>ORM for database</td>
                            </tr>
                            <tr>
                                <td>pydantic</td>
                                <td>2.11.5</td>
                                <td>Data validation</td>
                            </tr>
                            <tr>
                                <td>crewai</td>
                                <td>Latest</td>
                                <td>Multi-agent workflows (strategies)</td>
                            </tr>
                            <tr>
                                <td>openai</td>
                                <td>Latest</td>
                                <td>OpenAI API client</td>
                            </tr>
                            <tr>
                                <td>anthropic</td>
                                <td>Latest</td>
                                <td>Anthropic Claude API client</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Required Third-Party Services</h3>

                    <div class="info-box info-box-warning">
                        <div class="info-box-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            Required API Keys
                        </div>
                        <p>The following services require API keys configured in Settings:</p>
                    </div>

                    <h4>1. EODHD API (Market Data Provider)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> Stock EOD prices, fundamentals, financial news</li>
                        <li><strong>Endpoint:</strong> <code>https://eodhd.com/api/</code></li>
                        <li><strong>Authentication:</strong> API key</li>
                        <li><strong>Cost:</strong> Paid subscription required</li>
                        <li><strong>Usage:</strong> Market Intelligence module</li>
                    </ul>

                    <h4>2. OpenAI API (Primary LLM Provider)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> AI-powered signal generation and code generation</li>
                        <li><strong>Models Used:</strong> GPT-4, GPT-3.5-turbo</li>
                        <li><strong>Authentication:</strong> API key (sk-...)</li>
                        <li><strong>Cost:</strong> ~$0.03 per 1K tokens (GPT-4)</li>
                        <li><strong>Usage:</strong> Both modules (signals + strategy generation)</li>
                    </ul>

                    <h3>Optional Third-Party Services</h3>

                    <h4>3. Anthropic Claude API (Alternative LLM)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> Alternative LLM provider</li>
                        <li><strong>Models:</strong> Claude 3 Opus, Claude 3 Sonnet</li>
                        <li><strong>Usage:</strong> Signal generation (user selectable)</li>
                        <li><strong>Cost:</strong> ~$0.015 per 1K tokens</li>
                    </ul>

                    <h4>4. Ollama (Local LLM)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> Local LLM inference (no API costs)</li>
                        <li><strong>Models:</strong> llama2, mixtral, etc.</li>
                        <li><strong>Authentication:</strong> None (local)</li>
                        <li><strong>Cost:</strong> Free (requires local GPU)</li>
                    </ul>

                    <h4>5. Tavily API (Web Search)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> Macro environment research</li>
                        <li><strong>Usage:</strong> Macro agent in Market Intelligence</li>
                        <li><strong>Cost:</strong> Free tier available</li>
                    </ul>

                    <h4>6. QuantConnect API (Trading Platform)</h4>
                    <ul>
                        <li><strong>Purpose:</strong> Deploy algorithms for backtesting/live trading</li>
                        <li><strong>Endpoint:</strong> <code>https://www.quantconnect.com/api/v2/</code></li>
                        <li><strong>Authentication:</strong> User ID + API Token</li>
                        <li><strong>Cost:</strong> Free tier available, paid for live trading</li>
                    </ul>
                </section>

                <!-- API OVERVIEW SECTION -->
                <section id="api-overview">
                    <h2>API Overview</h2>

                    <h3>Core Functionality</h3>
                    <p>QuantCoderFS provides a RESTful API for two main workflows:</p>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Data Source: EODHD APIs
                        </div>
                        <p>
                            <strong>All market data is sourced from <a href="https://eodhd.com" target="_blank">EODHD Financial APIs</a>.</strong>
                            This includes end-of-day stock prices, fundamental data (financial statements, ratios),
                            and company news. An active EODHD subscription is required.
                        </p>
                        <p>
                            <strong>From this data, QuantCoderFS generates AI-powered trading signals</strong> using a multi-agent
                            system that analyzes fundamentals, news sentiment, price dynamics, and macroeconomic conditions.
                        </p>
                    </div>

                    <h3>Module 1: Market Intelligence API</h3>
                    <p>Automated equity research and signal generation using EODHD market data.</p>

                    <h4>API Endpoints Overview</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Endpoint</th>
                                <th>Method</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="6">Stocks</td>
                                <td>/api/stocks/create</td>
                                <td>POST</td>
                                <td>Create stock snapshot</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/tickers</td>
                                <td>GET</td>
                                <td>List all tickers</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/{ticker}/snapshots</td>
                                <td>GET</td>
                                <td>List snapshots</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/{ticker}/snapshots/{id}</td>
                                <td>GET</td>
                                <td>Load snapshot</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/refresh</td>
                                <td>POST</td>
                                <td>Refresh data</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/{ticker}/files/*</td>
                                <td>GET</td>
                                <td>Download files</td>
                            </tr>
                            <tr>
                                <td rowspan="4">Signals</td>
                                <td>/api/signals/generate/{project_id}</td>
                                <td>POST</td>
                                <td>Generate signal</td>
                            </tr>
                            <tr>
                                <td>/api/signals/snapshot/{ticker}/{id}</td>
                                <td>GET</td>
                                <td>Get snapshot signal</td>
                            </tr>
                            <tr>
                                <td>/api/signals/history/{ticker}</td>
                                <td>GET</td>
                                <td>Signal history</td>
                            </tr>
                            <tr>
                                <td>/api/signals/latest</td>
                                <td>GET</td>
                                <td>Latest signals</td>
                            </tr>
                            <tr>
                                <td rowspan="1">Returns</td>
                                <td>/api/stocks/{ticker}/snapshots/{id}/returns</td>
                                <td>GET</td>
                                <td>Calculate return statistics</td>
                            </tr>
                            <tr>
                                <td rowspan="1">Benchmark</td>
                                <td>/api/stocks/{ticker}/snapshots/{id}/benchmark</td>
                                <td>GET</td>
                                <td>Compare vs market benchmark</td>
                            </tr>
                            <tr>
                                <td rowspan="3">Research</td>
                                <td>/api/stocks/{ticker}/snapshots/{id}/research/generate</td>
                                <td>POST</td>
                                <td>Generate report</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/{ticker}/snapshots/{id}/research/files</td>
                                <td>GET</td>
                                <td>List reports</td>
                            </tr>
                            <tr>
                                <td>/api/stocks/{ticker}/snapshots/{id}/research/content/{file}</td>
                                <td>GET</td>
                                <td>Get report content</td>
                            </tr>
                            <tr>
                                <td rowspan="3">Settings</td>
                                <td>/api/settings</td>
                                <td>GET/POST</td>
                                <td>Manage API keys</td>
                            </tr>
                            <tr>
                                <td>/api/settings/quantconnect</td>
                                <td>GET/POST/DELETE</td>
                                <td>QC credentials</td>
                            </tr>
                            <tr>
                                <td>/api/settings/quantconnect/test</td>
                                <td>POST</td>
                                <td>Test connection</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Module 2: Strategy Generator API</h3>
                    <p>Automated QuantConnect algorithm generation from academic papers.</p>

                    <table>
                        <thead>
                            <tr>
                                <th>Endpoint</th>
                                <th>Method</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>/api/papers/upload</code></td>
                                <td>POST</td>
                                <td>Upload research paper (PDF)</td>
                            </tr>
                            <tr>
                                <td><code>/api/papers/list</code></td>
                                <td>GET</td>
                                <td>List uploaded papers</td>
                            </tr>
                            <tr>
                                <td><code>/api/strategy/generate</code></td>
                                <td>POST</td>
                                <td>Generate QuantConnect algorithm from paper</td>
                            </tr>
                            <tr>
                                <td><code>/api/backtest/trigger-backtest</code></td>
                                <td>POST</td>
                                <td>Deploy algorithm to QuantConnect</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Authentication</h3>
                    <p>API endpoints are currently unauthenticated (localhost development). For production deployment, implement JWT or API key authentication.</p>

                    <h3>Snapshot Architecture</h3>
                    <p>QuantCoderFS v2.0 introduced a snapshot-based architecture for stock data management:</p>

                    <h4>Key Concepts</h4>
                    <ul>
                        <li><strong>Snapshot ID:</strong> Timestamp in format <code>YYYYMMDD_HHMMSS</code> (e.g., <code>20251016_143022</code>)</li>
                        <li><strong>Multiple Snapshots:</strong> Each ticker can have multiple snapshots taken at different times</li>
                        <li><strong>Immutable Data:</strong> Once created, snapshot data doesn't change (refresh creates new snapshot)</li>
                        <li><strong>File Storage:</strong> All data stored in <code>/stocks/{ticker}/{snapshot_id}/</code> directory</li>
                        <li><strong>Independent Analysis:</strong> Each snapshot has its own signals and research reports</li>
                    </ul>

                    <h4>Benefits</h4>
                    <ul>
                        <li>Track how market conditions evolve over time</li>
                        <li>Compare signals generated on different dates</li>
                        <li>Reproducible analysis - same snapshot always yields same signal</li>
                        <li>Easy cleanup - delete old snapshots without affecting recent data</li>
                    </ul>

                    <p>See the <a href="api/stocks.html#snapshot-architecture">Stocks API documentation</a> for detailed snapshot management endpoints.</p>

                    <h3>Detailed API Documentation</h3>
                    <ul>
                        <li><a href="api/stocks.html">Stocks API</a> - Complete reference for stock data management</li>
                        <li><a href="api/signals.html">Signals API</a> - Complete reference for signal generation</li>
                        <li><a href="api/settings.html">Settings API</a> - Manage API keys and credentials</li>
                        <li><a href="api/research.html">Research API</a> - Generate comprehensive research reports</li>
                        <li><a href="#api-strategies">Strategies API</a> - Algorithm generation endpoints</li>
                        <li><a href="#api-backtest">Backtest API</a> - QuantConnect deployment</li>
                    </ul>
                </section>

                <!-- MARKET INTELLIGENCE SECTION -->
                <section id="market-intelligence">
                    <h2>Market Intelligence Module</h2>

                    <h3>Purpose</h3>
                    <p>Multi-agent equity research system inspired by <a href="https://arxiv.org/abs/2401.03737" target="_blank">MarketSense AI paper</a> (Fatouros et al., 2024).</p>

                    <h3>Screenshots</h3>

                    <div style="margin: 2rem 0;">
                        <h4>Return Distribution Analysis</h4>
                        <img src="assets/images/quantcoder40.png" alt="QuantCoderFS Return Distribution Analysis" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Return distribution analysis with statistical insights (daily/weekly/monthly returns, Sharpe ratio, win rate).</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Peer Comparison</h4>
                        <img src="assets/images/quantcoder41.png" alt="QuantCoderFS Peer Comparison" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Peer comparison: normalized performance across sector competitors.</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Portfolio Optimization</h4>
                        <img src="assets/images/quantcoder42.png" alt="QuantCoderFS Portfolio Analysis" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Portfolio optimization: equal-weight vs. max Sharpe with equity curves and composition.</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Stock Analysis with Benchmarks</h4>
                        <img src="assets/images/quantcoder43.png" alt="QuantCoderFS Stock Analysis" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Stock data view with price chart, fundamentals, and benchmark comparison (SPY, QQQ, DIA, IWM).</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Onboarding Wizard</h4>
                        <img src="assets/images/quantcoder44.png" alt="QuantCoderFS Onboarding" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Onboarding wizard: 6-step setup for license, API keys, and QuantConnect integration.</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>API Keys Setup</h4>
                        <img src="assets/images/quantcoder45.png" alt="QuantCoderFS API Keys" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">API keys setup: EODHD, OpenAI (required), Tavily (optional for deep research).</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>QuantConnect Integration</h4>
                        <img src="assets/images/quantcoder46.png" alt="QuantCoderFS QuantConnect Setup" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">QuantConnect integration: User ID, API Token, Organization ID for strategy deployment.</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Settings Page</h4>
                        <img src="assets/images/quantcoder47.png" alt="QuantCoderFS Settings" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Settings page: License activation, API credentials, and AI model configuration.</p>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Returns Tab - Statistical Return Analysis</h4>
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">
                            Comprehensive statistical analysis of historical return distributions with interactive histogram visualization.
                        </p>
                        <div class="info-box info-box-info">
                            <div class="info-box-title">
                                <i class="fas fa-chart-bar"></i>
                                Return Distribution Methodology
                            </div>
                            <p><strong>Return Calculation:</strong></p>
                            <div style="font-family: 'Courier New', monospace; background-color: var(--bg-secondary); padding: 10px; border-radius: 4px; margin: 10px 0;">
                                Return(t) = [(Price(t) - Price(t-1)) / Price(t-1)] × 100
                            </div>
                            <p><strong>Supported Periods:</strong> Daily, Weekly (Friday close), Monthly (month-end)</p>
                            <p><strong>Lookback Options:</strong> 3M, 6M, 1Y, 2Y, 3Y, 5Y</p>

                            <p style="margin-top: 1rem;"><strong>Key Statistics Displayed:</strong></p>
                            <ul>
                                <li><strong>Mean Return:</strong> Average return over the period (positive = upward trend)</li>
                                <li><strong>Volatility (σ):</strong> Standard deviation of returns (higher = more risk)</li>
                                <li><strong>Sharpe Ratio (Annualized):</strong> Risk-adjusted return metric
                                    <div style="font-size: 0.85em; color: var(--text-secondary); margin-left: 20px;">
                                        Formula: Sharpe = (Mean / StdDev) × √periods_per_year<br>
                                        Interpretation: &gt;1 = good, 0-1 = modest, &lt;0 = poor risk-adjusted returns
                                    </div>
                                </li>
                                <li><strong>Skewness:</strong> Distribution asymmetry
                                    <div style="font-size: 0.85em; color: var(--text-secondary); margin-left: 20px;">
                                        Positive = right tail longer (large gains more likely)<br>
                                        Negative = left tail longer (large losses more likely)
                                    </div>
                                </li>
                                <li><strong>Kurtosis:</strong> Tail heaviness (values &gt;3 = heavy tails, higher extreme return probability)</li>
                                <li><strong>Win Rate:</strong> Percentage of periods with positive returns</li>
                                <li><strong>Min/Max Returns:</strong> Extreme value ranges</li>
                            </ul>

                            <p style="margin-top: 1rem;"><strong>Histogram Visualization:</strong></p>
                            <p>30-bin frequency distribution revealing:</p>
                            <ul>
                                <li>Return clustering patterns (most common return ranges)</li>
                                <li>Distribution shape (symmetric, skewed, or multi-modal)</li>
                                <li>Tail behavior (frequency of extreme gains/losses)</li>
                                <li>Deviation from normal distribution assumptions</li>
                            </ul>

                            <p style="margin-top: 1rem;"><strong>Example Interpretation:</strong></p>
                            <div style="background-color: rgba(88, 166, 255, 0.1); padding: 10px; border-left: 3px solid #58a6ff; margin-top: 10px;">
                                <p style="margin: 0; font-weight: bold;">Daily Analysis: Mean 0.5%, σ 2.1%, Sharpe 1.5, Skewness -0.3, Kurtosis 4.2, Win Rate 55%</p>
                                <ul style="margin-top: 5px; font-size: 0.9em;">
                                    <li>✓ Positive average daily return (upward trend)</li>
                                    <li>✓ Good risk-adjusted returns (Sharpe &gt;1)</li>
                                    <li>⚠ Left-skewed (downside tail longer — larger losses more likely)</li>
                                    <li>⚠ Heavy tails (elevated risk of extreme moves)</li>
                                    <li>✓ 55% of days positive (slight edge)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Benchmark Tab - Market Comparison</h4>
                        <img src="assets/images/quantcoder43.png" alt="QuantCoderFS Market Intelligence - Benchmark Comparison" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Compare stock performance against market benchmarks (SPY, QQQ, DIA, IWM) with Alpha, Beta, correlation metrics, and Up/Down capture ratios.</p>

                        <div class="info-box info-box-info">
                            <div class="info-box-title">
                                <i class="fas fa-chart-area"></i>
                                Benchmark Comparison Methodology
                            </div>
                            <p><strong>Key Metrics Calculated:</strong></p>
                            <ul>
                                <li><strong>Alpha (Annualized):</strong> Excess return compared to benchmark
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Alpha = Mean(Stock Return - Benchmark Return) × 252
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Positive alpha indicates outperformance; negative indicates underperformance.</div>
                                </li>
                                <li><strong>Beta:</strong> Systematic risk relative to benchmark
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Beta = Cov(Stock, Benchmark) / Var(Benchmark)
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Beta &gt; 1: More volatile; Beta &lt; 1: Less volatile; Beta ≈ 1: Similar volatility</div>
                                </li>
                                <li><strong>Correlation:</strong> Degree of linear relationship with benchmark
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Correlation = Pearson(Stock Returns, Benchmark Returns)
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Range: -1 to +1. High correlation (&gt;0.8): Moves with market; Low correlation (&lt;0.5): Independent behavior</div>
                                </li>
                                <li><strong>Tracking Error (Annualized):</strong> Deviation from benchmark
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Tracking Error = StdDev(Excess Returns) × √252
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Higher tracking error indicates more independent performance from benchmark.</div>
                                </li>
                                <li><strong>Information Ratio:</strong> Risk-adjusted alpha
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        IR = Alpha / Tracking Error
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">IR &gt; 0.5: Good risk-adjusted outperformance; IR &lt; 0: Underperformance</div>
                                </li>
                                <li><strong>Up Capture Ratio:</strong> Performance on benchmark's up days
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Up Capture = [Mean(Stock Returns | Benchmark &gt; 0) / Mean(Benchmark Returns | Benchmark &gt; 0)] × 100
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Up Capture &gt; 100%: Outperforms on up days; &lt;100%: Underperforms on up days</div>
                                </li>
                                <li><strong>Down Capture Ratio:</strong> Performance on benchmark's down days
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Down Capture = [Mean(Stock Returns | Benchmark &lt; 0) / Mean(Benchmark Returns | Benchmark &lt; 0)] × 100
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Down Capture &lt; 100%: Protects on down days (good); &gt;100%: Amplifies losses (bad)</div>
                                </li>
                                <li><strong>Sharpe Ratios:</strong> Risk-adjusted returns for both stock and benchmark
                                    <div style="font-family: 'Courier New', monospace; font-size: 0.85em; color: #58a6ff; margin-top: 3px;">
                                        Sharpe = (Mean Return / StdDev) × √252
                                    </div>
                                    <div style="font-size: 0.85em; margin-top: 3px;">Compare Sharpe ratios to see which asset has better risk-adjusted returns.</div>
                                </li>
                            </ul>

                            <p style="margin-top: 10px;"><strong>Normalized Performance Chart:</strong></p>
                            <p style="font-size: 0.9em;">Both stock and benchmark prices are normalized to start at 100 to visualize relative performance over time. The stock line is solid, the benchmark line is dashed.</p>
                        </div>

                        <div style="background: var(--background-secondary); padding: 15px; border-left: 4px solid var(--accent); border-radius: 4px; margin-top: 1rem;">
                            <div style="font-weight: bold; margin-bottom: 8px;">Example Interpretation:</div>
                            <div style="font-size: 0.9em;">
                                <p><strong>Stock:</strong> AAPL | <strong>Benchmark:</strong> SPY | <strong>Period:</strong> 12 months</p>
                                <ul style="margin-top: 5px; font-size: 0.9em;">
                                    <li>✓ Alpha = +5.2% (outperformed S&P 500 by 5.2% annualized)</li>
                                    <li>✓ Beta = 1.15 (15% more volatile than market)</li>
                                    <li>✓ Correlation = 0.82 (high correlation - moves with market)</li>
                                    <li>✓ Information Ratio = 0.68 (good risk-adjusted outperformance)</li>
                                    <li>✓ Up Capture = 112% (captures 12% more gains on up days)</li>
                                    <li>✓ Down Capture = 95% (protects 5% better on down days)</li>
                                    <li>✓ Tracking Error = 7.6% (moderate deviation from benchmark)</li>
                                    <li>✓ Sharpe (AAPL) = 1.2 vs Sharpe (SPY) = 0.9 (better risk-adjusted returns)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div style="margin: 2rem 0;">
                        <h4>Peers Tab - Sector Comparison</h4>
                        <img src="assets/images/quantcoder41.png" alt="QuantCoderFS Market Intelligence - Peer Comparison" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Compare performance against sector peers with normalized price charts showing relative outperformance/underperformance.</p>
                    </div>

                    <h3>Agent Architecture</h3>
                    <p>The system uses <strong>5 specialized agents</strong> working in orchestration:</p>

                    <h4>1. Fundamentals Summarizer Agent (30% weight)</h4>
                    <ul>
                        <li><strong>Input:</strong> Quarterly financial statements, company highlights</li>
                        <li><strong>Processing:</strong> Financial health score, revenue growth, profit margins</li>
                        <li><strong>Output:</strong> Summary (100-200 words) + Score (0-100)</li>
                    </ul>

                    <h4>2. Progressive News Summarizer Agent (25% weight)</h4>
                    <ul>
                        <li><strong>Input:</strong> 60-day rolling news articles</li>
                        <li><strong>Processing:</strong> Sentiment aggregation, narrative themes</li>
                        <li><strong>Output:</strong> Summary + Sentiment score (0-100)</li>
                    </ul>

                    <h4>3. Stock-Price Dynamics Summarizer Agent (25% weight)</h4>
                    <ul>
                        <li><strong>Input:</strong> OHLCV price data (1 year), S&P 500 benchmark</li>
                        <li><strong>Processing:</strong> Technical analysis (MA, RSI, MACD), volatility</li>
                        <li><strong>Output:</strong> Summary + Technical score (0-100)</li>
                    </ul>

                    <h4>4. Macroeconomic Environment Summarizer Agent (20% weight)</h4>
                    <ul>
                        <li><strong>Input:</strong> Sector information, web search results (via Tavily)</li>
                        <li><strong>Processing:</strong> Sector analysis, economic cycle assessment</li>
                        <li><strong>Output:</strong> Summary + Macro score (0-100)</li>
                    </ul>

                    <h4>5. Signal Generation Agent (Master Orchestrator)</h4>
                    <ul>
                        <li><strong>Input:</strong> Outputs from all 4 summarizer agents</li>
                        <li><strong>Processing:</strong> Chain-of-Thought reasoning, weighted consensus</li>
                        <li><strong>Output:</strong> Final BUY/HOLD/SELL signal with conviction (1-10) and confidence (0.0-1.0)</li>
                    </ul>

                    <h3>Signal Calculation Formula</h3>
                    <pre><code>weighted_score = (
    fundamentals_score * 0.30 +
    news_score * 0.25 +
    price_dynamics_score * 0.25 +
    macro_score * 0.20
)

if weighted_score >= 70:
    signal = "BUY"
elif weighted_score <= 40:
    signal = "SELL"
else:
    signal = "HOLD"</code></pre>

                    <div class="info-box info-box-success">
                        <div class="info-box-title">
                            <i class="fas fa-chart-line"></i>
                            MarketSense AI Research Results
                        </div>
                        <p>The original MarketSense AI paper (Fatouros et al., 2024) reported the following results from academic testing on S&P 100 stocks over 15 months:</p>
                        <ul>
                            <li>Excess alpha: <strong>10-30%</strong></li>
                            <li>Cumulative return: Up to <strong>72%</strong></li>
                            <li>Multi-agent consensus outperformed individual agents significantly</li>
                        </ul>
                        <p><em>Note: These are research results from the original paper. QuantCoderFS is inspired by this framework but is not identical to the research implementation.</em></p>
                    </div>

                    <h3>Data Flow</h3>
                    <ol>
                        <li>User creates stock project (<code>POST /api/stocks/create</code>)</li>
                        <li>System fetches data from EODHD API (EOD prices, fundamentals, news)</li>
                        <li>Data stored in file system: <code>user_workdir/stocks/{ticker}_{timestamp}/</code></li>
                        <li>User generates signal (<code>POST /api/signals/generate/{project_id}</code>)</li>
                        <li>Signal Orchestrator runs agents in sequence (60-90 seconds)</li>
                        <li>Results saved to database + file system</li>
                        <li>Frontend displays signal with agent breakdowns</li>
                    </ol>
                </section>

                <!-- STRATEGY GENERATOR SECTION -->
                <section id="strategy-generator">
                    <h2>Strategy Generator Module</h2>

                    <h3>Purpose</h3>
                    <p>Automated QuantConnect algorithm generation from academic research papers using <strong>CrewAI</strong>.</p>

                    <h3>Screenshot</h3>

                    <div style="margin: 2rem 0;">
                        <h4>Strategy Generator - Paper to Code</h4>
                        <img src="assets/images/quantcoder30.png" alt="QuantCoderFS Strategy Generator - Algorithm Code Generation" style="width: 100%; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 1rem;">
                        <p style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">Upload academic research papers (left panel) and generate complete QuantConnect algorithm code (right panel) using CrewAI multi-agent workflow. Monaco editor with Python syntax highlighting and line numbers.</p>
                    </div>

                    <h3>CrewAI Workflow</h3>

                    <h4>Crew 1: Paper Extraction</h4>
                    <ul>
                        <li><strong>Agent:</strong> Paper Analyzer Agent</li>
                        <li><strong>Role:</strong> Extract strategy from research paper</li>
                        <li><strong>Tool:</strong> PDFAnalyserTool (PDF parsing)</li>
                        <li><strong>Output:</strong> Structured strategy summary (JSON)</li>
                    </ul>

                    <h4>Crew 2: Code Generation</h4>
                    <ul>
                        <li><strong>Agent 1:</strong> Strategy Summarizer (condense paper into trading rules)</li>
                        <li><strong>Agent 2:</strong> Code Generator (write QuantConnect algorithm)</li>
                        <li><strong>Agent 3:</strong> Code Validator (review and fix code issues)</li>
                        <li><strong>Output:</strong> Complete QuantConnect <code>.py</code> algorithm file</li>
                    </ul>

                    <h3>QuantConnect Integration</h3>
                    <p><strong>Endpoint:</strong> <code>POST /api/backtest/trigger-backtest</code></p>

                    <p><strong>Workflow:</strong></p>
                    <ol>
                        <li>Get QC credentials from database</li>
                        <li>Create QC project via REST API</li>
                        <li>Upload algorithm code to project</li>
                        <li>Compile code</li>
                        <li>Wait for compilation</li>
                        <li>Create backtest</li>
                        <li>Return backtest ID and project URL</li>
                    </ol>

                    <p><strong>Request Example:</strong></p>
                    <pre><code>{
  "code": "# QuantConnect algorithm code",
  "project_name": "My Momentum Strategy"
}</code></pre>

                    <p><strong>Response Example:</strong></p>
                    <pre><code>{
  "status": "success",
  "project_id": 12345678,
  "backtest_id": "abc123",
  "project_url": "https://www.quantconnect.com/project/12345678"
}</code></pre>
                </section>

                <!-- API REFERENCE SECTIONS -->
                <section id="api-strategies">
                    <h2>Strategies API Reference</h2>

                    <h3>Upload PDF Paper</h3>
                    <pre><code>POST /api/papers/upload
Content-Type: multipart/form-data

file: (binary PDF data)

Response 200:
{
  "filename": "momentum_strategy.pdf",
  "size": 1024000,
  "path": "/path/to/papers/momentum_strategy.pdf"
}</code></pre>

                    <h3>List Papers</h3>
                    <pre><code>GET /api/papers/list

Response 200:
[
  {
    "filename": "momentum_strategy.pdf",
    "size_kb": 1000,
    "uploaded": "2025-10-14T10:00:00"
  }
]</code></pre>

                    <h3>Generate Code from Paper</h3>
                    <pre><code>POST /api/papers/generate-code/momentum_strategy.pdf

Response 200:
{
  "filename": "momentum_strategy.py",
  "code": "# region imports\nfrom AlgorithmImports import *\n...",
  "summary": "Strategy extracted from paper"
}</code></pre>

                    <h3>List Generated Code</h3>
                    <pre><code>GET /api/papers/list?folder=codes

Response 200:
[
  {
    "filename": "momentum_strategy.py",
    "size_kb": 15,
    "generated": "2025-10-14T10:30:00"
  }
]</code></pre>
                </section>

                <section id="api-backtest">
                    <h2>Backtest API Reference</h2>

                    <h3>Push to QuantConnect</h3>
                    <pre><code>POST /api/backtest/trigger-backtest
Content-Type: application/json

{
  "code": "# Algorithm code here",
  "project_name": "My Momentum Strategy"
}

Response 200:
{
  "status": "success",
  "project_id": 12345678,
  "backtest_id": "abc123def456",
  "project_url": "https://www.quantconnect.com/project/12345678"
}</code></pre>

                    <div class="info-box info-box-note">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            QuantConnect Credentials Required
                        </div>
                        <p>You must configure QuantConnect User ID and API Token in Settings before using this endpoint.</p>
                    </div>
                </section>

                <!-- AGENTS SECTION -->
                <section id="agents">
                    <h2>Agentic Frameworks</h2>

                    <h3>Market Intelligence: Custom Multi-Agent System</h3>
                    <p><strong>Inspiration:</strong> MarketSense AI (Fatouros et al., 2024)</p>
                    <p><strong>Paper:</strong> <a href="https://arxiv.org/abs/2401.03737" target="_blank">https://arxiv.org/abs/2401.03737</a></p>

                    <p><strong>Agent Weighting:</strong></p>
                    <ul>
                        <li>Fundamentals: <strong>30%</strong></li>
                        <li>News: <strong>25%</strong></li>
                        <li>Price Dynamics: <strong>25%</strong></li>
                        <li>Macro: <strong>20%</strong></li>
                    </ul>

                    <p><strong>Key Differences from MarketSense AI Paper:</strong></p>
                    <ul>
                        <li>Implementation uses FastAPI instead of standalone Python scripts</li>
                        <li>LLM provider is configurable (OpenAI/Anthropic/Ollama)</li>
                        <li>Agents use different prompts tuned for specific data sources</li>
                        <li>Signal persistence in SQL database</li>
                    </ul>

                    <h3>Strategy Generator: v4 Robust Workflow</h3>
                    <p><strong>Architecture:</strong> Multi-phase direct LLM workflow (no CrewAI overhead)</p>

                    <div class="info-box info-box-success">
                        <div class="info-box-title">
                            <i class="fas fa-check-circle"></i>
                            v4 Robust Workflow - Production Ready
                        </div>
                        <p><strong>Performance:</strong> ~30-45 seconds execution time | <strong>Success Rate:</strong> 90-95% (matches Claude's direct coding quality)</p>
                        <p><strong>Status:</strong> Recommended for production use</p>
                    </div>

                    <h4>Workflow Evolution</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Version</th>
                                <th>Architecture</th>
                                <th>Time</th>
                                <th>Success Rate</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>v1</td>
                                <td>5 CrewAI agents sequential</td>
                                <td>5+ min</td>
                                <td>~60%</td>
                                <td>❌ Deprecated</td>
                            </tr>
                            <tr>
                                <td>v2</td>
                                <td>3 CrewAI agents sequential</td>
                                <td>4+ min</td>
                                <td>~75%</td>
                                <td>⚠️ Slow</td>
                            </tr>
                            <tr>
                                <td>v3</td>
                                <td>Single LLM call + KB</td>
                                <td>~25s</td>
                                <td>~85%</td>
                                <td>✅ Fast but simple</td>
                            </tr>
                            <tr style="background-color: var(--success-bg);">
                                <td><strong>v4</strong></td>
                                <td><strong>Multi-phase + validation + iteration</strong></td>
                                <td><strong>~30-45s</strong></td>
                                <td><strong>~90-95%</strong></td>
                                <td><strong>✅ Recommended</strong></td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>v4 Workflow Phases</h4>
                    <p>The v4 workflow consists of 5 sequential phases that mirror how Claude codes directly:</p>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Phase 1: Deep PDF Analysis (~8-10s)
                        </div>
                        <p><strong>Purpose:</strong> Understand complete strategy before coding</p>
                        <ul>
                            <li>Extract full PDF text using PDFLoader</li>
                            <li>LLM analyzes paper and extracts structured JSON with:
                                <ul>
                                    <li>Strategy name, universe, timeframe</li>
                                    <li>Indicators required (e.g., "252-day momentum", "RSI(14)")</li>
                                    <li>Entry/exit rules (specific conditions)</li>
                                    <li>Risk management parameters</li>
                                    <li>Key numeric parameters</li>
                                </ul>
                            </li>
                            <li>Output: Actionable implementation plan</li>
                        </ul>
                        <p><strong>Why This Works:</strong> Forces structured thinking before coding (like Claude reading a paper first)</p>
                    </div>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Phase 2: Code Generation (~8-10s)
                        </div>
                        <p><strong>Purpose:</strong> Generate complete algorithm using structured analysis + knowledge base</p>
                        <ul>
                            <li>Build comprehensive prompt with:
                                <ul>
                                    <li>Structured analysis from Phase 1 (WHAT to implement)</li>
                                    <li>QuantConnect knowledge base (HOW to implement correctly)</li>
                                    <li>Common mistakes warnings (what NOT to do)</li>
                                </ul>
                            </li>
                            <li>Direct LLM call (no CrewAI overhead)</li>
                            <li>Output: Raw Python code ready for validation</li>
                        </ul>
                        <p><strong>Knowledge Base:</strong> 13KB curated examples from official QuantConnect/Lean repository</p>
                    </div>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Phase 3: Comprehensive Validation (&lt;1s)
                        </div>
                        <p><strong>Purpose:</strong> Check for 9 common error patterns</p>
                        <ul>
                            <li><strong>9 Validation Checks:</strong>
                                <ol>
                                    <li>Syntax validation (AST parsing)</li>
                                    <li>Required imports (<code>from AlgorithmImports import *</code>)</li>
                                    <li>Class structure (inherits <code>QCAlgorithm</code>)</li>
                                    <li>Required methods (<code>initialize()</code>, <code>on_data()</code> - snake_case)</li>
                                    <li>API naming correctness (enforce snake_case: <code>set_start_date()</code> not <code>SetStartDate()</code>)</li>
                                    <li>Indicator naming conflicts (use <code>self._rsi</code> not <code>self.rsi</code>)</li>
                                    <li>Indicator ready checks (<code>if not self._rsi.is_ready: return</code>)</li>
                                    <li>TimeRules API correctness (e.g., <code>after_market_open()</code> exists)</li>
                                    <li>Risk management presence (position checks before trading)</li>
                                </ol>
                            </li>
                            <li>Output: List of specific error messages (empty if all checks pass)</li>
                        </ul>
                    </div>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Phase 4: Targeted Refinement (~8-10s per iteration, max 2x)
                        </div>
                        <p><strong>Purpose:</strong> Fix specific errors using LLM with full context</p>
                        <ul>
                            <li>Triggered only if validation errors found</li>
                            <li>Provide LLM with:
                                <ul>
                                    <li>Original strategy context (from Phase 1)</li>
                                    <li>Current code with issues</li>
                                    <li>Specific error messages</li>
                                </ul>
                            </li>
                            <li>LLM fixes errors while preserving strategy logic</li>
                            <li>Re-validate after each fix</li>
                            <li>Maximum 2 iterations (prevents infinite loops)</li>
                        </ul>
                        <p><strong>Why This Works:</strong> Targeted fixes with context (like Claude fixing specific compiler errors)</p>
                    </div>

                    <div class="info-box info-box-info">
                        <div class="info-box-title">
                            <i class="fas fa-info-circle"></i>
                            Phase 5: Safety Net Post-Processing (&lt;1s)
                        </div>
                        <p><strong>Purpose:</strong> Auto-fix remaining known issues</p>
                        <ul>
                            <li>Regex-based safety net fixes:
                                <ul>
                                    <li>Remove <code>RollingWindow[float]</code> type hints → <code>RollingWindow()</code></li>
                                    <li>Fix any remaining PascalCase → snake_case</li>
                                    <li>Fix <code>market_open_hours()</code> → <code>after_market_open()</code></li>
                                    <li>Fix indicator naming conflicts</li>
                                </ul>
                            </li>
                            <li>Defense in depth: Phase 4 fixes with understanding, Phase 5 catches edge cases</li>
                        </ul>
                    </div>

                    <h4>Why v4 Achieves 90-95% Success Rate</h4>
                    <p>v4 replicates the same process that makes Claude's direct coding successful:</p>
                    <ol>
                        <li><strong>Complete Context Understanding</strong> - Deep PDF analysis before coding (Phase 1)</li>
                        <li><strong>Use of Real Examples</strong> - Knowledge base with 5 real QuantConnect algorithms (Phase 2)</li>
                        <li><strong>Specific Pattern Matching</strong> - 9 validation checks targeting known errors (Phase 3)</li>
                        <li><strong>Actionable Error Feedback</strong> - Targeted refinement with error context (Phase 4)</li>
                        <li><strong>Safety Net</strong> - Auto-fix post-processing handles edge cases (Phase 5)</li>
                    </ol>

                    <h4>Key Differences from v3 (Fast)</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Aspect</th>
                                <th>v3 (Fast)</th>
                                <th>v4 (Robust)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PDF Analysis</td>
                                <td>First 8000 chars only</td>
                                <td>Structured extraction of all strategy details</td>
                            </tr>
                            <tr>
                                <td>Validation</td>
                                <td>None (AST only in post)</td>
                                <td>9 comprehensive checks</td>
                            </tr>
                            <tr>
                                <td>Error Recovery</td>
                                <td>Cannot recover</td>
                                <td>Up to 2 targeted refinement iterations</td>
                            </tr>
                            <tr>
                                <td>Context Quality</td>
                                <td>Good (KB + partial PDF)</td>
                                <td>Excellent (structured analysis + KB)</td>
                            </tr>
                            <tr>
                                <td>Speed</td>
                                <td>~25s</td>
                                <td>~30-45s</td>
                            </tr>
                            <tr>
                                <td>Success Rate</td>
                                <td>~85%</td>
                                <td>~90-95%</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box info-box-warning">
                        <div class="info-box-title">
                            <i class="fas fa-exclamation-triangle"></i>
                            Why Not CrewAI?
                        </div>
                        <p>v4 uses direct LLM calls instead of CrewAI because CrewAI adds zero value in this use case:</p>
                        <ul>
                            <li>❌ No agent delegation (<code>allow_delegation=False</code>)</li>
                            <li>❌ No real tools (just prompt wrappers, not actual compilation/testing)</li>
                            <li>❌ No memory (no learning between runs)</li>
                            <li>❌ Only sequential execution (expensive prompt sequencing)</li>
                        </ul>
                        <p><strong>Result:</strong> v4 achieves 10x speed improvement (v1: 5min → v4: 45s) while maintaining 90-95% quality.</p>
                        <p><strong>Future Enhancement:</strong> CrewAI would be valuable with REAL tools (QuantConnect MCP for compilation feedback, doc search, backtest analysis).</p>
                    </div>

                    <h4>Implementation Files</h4>
                    <ul>
                        <li><code>backend/strategy_generator/flows/code_v4_robust.py</code> - Main workflow</li>
                        <li><code>backend/strategy_generator/knowledge_base/quantconnect_examples.md</code> - Knowledge base (13KB)</li>
                        <li><code>backend/strategy_generator/knowledge_base/__init__.py</code> - KB loader</li>
                        <li><code>backend/strategy_generator/routers/coder.py</code> - API endpoints</li>
                    </ul>
                </section>

                <!-- LLM PROVIDERS SECTION -->
                <section id="llm-providers">
                    <h2>LLM Providers</h2>

                    <h3>Supported Providers</h3>

                    <h4>1. OpenAI (Default)</h4>
                    <ul>
                        <li><strong>Models Used:</strong> GPT-4, GPT-3.5-turbo</li>
                        <li><strong>Cost:</strong> ~$0.03 per 1K tokens (GPT-4)</li>
                        <li><strong>Usage:</strong> Both modules</li>
                    </ul>

                    <h4>2. Anthropic Claude</h4>
                    <ul>
                        <li><strong>Models Used:</strong> Claude 3 Opus, Claude 3 Sonnet</li>
                        <li><strong>Cost:</strong> ~$0.015 per 1K tokens</li>
                        <li><strong>Usage:</strong> Market Intelligence signals only (user selectable)</li>
                    </ul>

                    <h4>3. Ollama (Local)</h4>
                    <ul>
                        <li><strong>Models Used:</strong> llama2, mixtral, etc.</li>
                        <li><strong>Cost:</strong> Free (requires local GPU)</li>
                        <li><strong>Usage:</strong> Market Intelligence signals only (user selectable)</li>
                    </ul>

                    <h3>Provider Selection</h3>
                    <ul>
                        <li><strong>Market Intelligence:</strong> User chooses via query parameter (<code>?llm_provider=openai</code>)</li>
                        <li><strong>Strategy Generator:</strong> Always uses OpenAI (CrewAI default)</li>
                    </ul>
                </section>

                <!-- DATABASE SECTION -->
                <section id="database">
                    <h2>Database Schema</h2>

                    <h3>UserSettings Table</h3>
                    <pre><code>CREATE TABLE user_settings (
    id INTEGER PRIMARY KEY,
    eodhd_api_key TEXT,
    openai_api_key TEXT,
    anthropic_api_key TEXT,
    tavily_api_key TEXT,
    qc_user_id TEXT,
    qc_api_token TEXT,
    qc_organization_id TEXT,
    default_llm_provider TEXT DEFAULT 'openai',
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);</code></pre>

                    <h3>TradingSignal Table</h3>
                    <pre><code>CREATE TABLE trading_signals (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    ticker TEXT NOT NULL,
    signal TEXT NOT NULL,  -- BUY, HOLD, SELL
    conviction INTEGER,     -- 1-10
    confidence REAL,        -- 0.0-1.0
    reasoning TEXT,
    weighted_score REAL,
    llm_provider TEXT,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);</code></pre>

                    <h3>AgentOutput Table</h3>
                    <pre><code>CREATE TABLE agent_outputs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    signal_id INTEGER NOT NULL,  -- FK to trading_signals
    agent_name TEXT NOT NULL,    -- fundamentals, news, etc.
    summary TEXT,
    score REAL,
    raw_output TEXT,             -- JSON blob
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (signal_id) REFERENCES trading_signals(id)
);</code></pre>
                </section>

                <!-- INSTALLATION SECTION -->
                <section id="installation">
                    <h2>Installation & Setup</h2>

                    <h3>Prerequisites</h3>
                    <ul>
                        <li>Python 3.12+</li>
                        <li>Node.js 18+</li>
                        <li>EODHD API key (required)</li>
                        <li>OpenAI API key (required)</li>
                    </ul>

                    <h3>Backend Setup</h3>
                    <pre><code># Extract licensed software package
# (Provided after subscription at quantcoderfs.substack.com)
cd quantcoderfs/backend

# Create virtual environment
python3 -m venv .venv
source .venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Run database migrations
alembic upgrade head

# Start backend server
uvicorn main:app --reload --port 8000</code></pre>

                    <p><strong>Backend runs at:</strong> <code>http://localhost:8000</code></p>
                    <p><strong>API docs:</strong> <code>http://localhost:8000/docs</code></p>

                    <h3>Frontend Setup</h3>
                    <pre><code>cd ../electron

# Install dependencies
npm install

# Create environment file
echo "NEXT_PUBLIC_API_BASE_URL=http://localhost:8000" > .env.local

# Start development server
npm run dev</code></pre>

                    <p><strong>Frontend runs at:</strong> <code>http://localhost:3001</code></p>

                    <h3>Configuration</h3>
                    <ol>
                        <li>Open <code>http://localhost:3001</code></li>
                        <li>Navigate to <strong>Settings</strong> page</li>
                        <li>Enter API keys:
                            <ul>
                                <li>EODHD API Key (required)</li>
                                <li>OpenAI API Key (required)</li>
                                <li>Tavily API Key (optional)</li>
                                <li>QuantConnect User ID (optional)</li>
                                <li>QuantConnect API Token (optional)</li>
                            </ul>
                        </li>
                        <li>Save settings</li>
                    </ol>

                    <div class="info-box info-box-success">
                        <div class="info-box-title">
                            <i class="fas fa-rocket"></i>
                            Quick Start
                        </div>
                        <p>Use the launch script for one-command startup:</p>
                        <pre><code>./launch.sh</code></pre>
                    </div>
                </section>

                <!-- DISCLAIMER -->
                <div class="info-box info-box-warning">
                    <div class="info-box-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        Disclaimer
                    </div>
                    <p>QuantCoderFS is a research and educational tool. All generated signals, analyses, and trading algorithms are for informational purposes only and should not be considered financial advice. Always conduct your own research and consult with qualified financial advisors before making investment decisions.</p>
                </div>

                <!-- REFERENCES -->
                <section>
                    <h2>References</h2>
                    <ol>
                        <li>Fatouros, G., Soldatos, J., Kouroumali, K., Makridis, G., & Kyriazis, D. (2024). MarketSense AI: Multi-Agent LLM Framework for Stock Market Analysis. <em>arXiv preprint arXiv:2401.03737</em>. <a href="https://arxiv.org/abs/2401.03737" target="_blank">https://arxiv.org/abs/2401.03737</a></li>
                        <li>QuantConnect. (2025). LEAN Algorithmic Trading Engine Documentation. <a href="https://www.quantconnect.com/docs" target="_blank">https://www.quantconnect.com/docs</a></li>
                        <li>CrewAI. (2025). Multi-Agent Framework Documentation. <a href="https://docs.crewai.com" target="_blank">https://docs.crewai.com</a></li>
                    </ol>
                </section>

            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="docs-footer">
        <p>&copy; 2025 QuantCoderFS Documentation | Self-Hosted Commercial Software | <a href="../index.html">Back to Main Site</a></p>
    </footer>

    <script src="assets/js/docs.js"></script>
</body>
</html>
