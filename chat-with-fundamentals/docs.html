<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Fundamentals v2.0.0 Documentation - Technical Reference</title>
    <link rel="stylesheet" href="assets/css/docs.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Documentation Header -->
    <header class="docs-header">
        <div class="docs-header-content">
            <a href="docs.html" class="docs-logo">
                <i class="fas fa-database"></i>
                <span>Chat with Fundamentals</span>
            </a>
            <nav>
                <ul class="docs-nav">
                    <li><a href="docs.html" class="active">Documentation</a></li>
                    <li><a href="https://quantcoder-fs.com" target="_blank"><i class="fas fa-globe"></i> Website</a></li>
                </ul>
            </nav>
            <a href="../index.html" class="back-to-main"><i class="fas fa-arrow-left"></i> Back to Main Site</a>
        </div>
    </header>

    <!-- Documentation Container -->
    <div class="docs-container">
        <!-- Left Sidebar Navigation -->
        <aside class="docs-sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Getting Started</div>
                <ul class="sidebar-menu">
                    <li><a href="#overview"><i class="fas fa-home"></i> Overview</a></li>
                    <li><a href="#architecture"><i class="fas fa-sitemap"></i> Architecture</a></li>
                    <li><a href="#installation"><i class="fas fa-download"></i> Installation</a></li>
                    <li><a href="#tech-stack"><i class="fas fa-layer-group"></i> Tech Stack</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Core Features</div>
                <ul class="sidebar-menu">
                    <li><a href="#portfolio-management"><i class="fas fa-briefcase"></i> Portfolio Management</a></li>
                    <li><a href="#ai-analysis"><i class="fas fa-robot"></i> AI Analysis</a></li>
                    <li><a href="#rag-systems"><i class="fas fa-brain"></i> RAG Systems</a></li>
                    <li><a href="#database-management"><i class="fas fa-database"></i> Database Management</a></li>
                    <li><a href="#data-api"><i class="fas fa-cloud-download-alt"></i> EODHD Data API</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">API Reference</div>
                <ul class="sidebar-menu">
                    <li><a href="#api-overview"><i class="fas fa-book"></i> API Overview</a></li>
                    <li><a href="#api-portfolio"><i class="fas fa-wallet"></i> Portfolio API</a></li>
                    <li><a href="#api-ai-analysis"><i class="fas fa-chart-line"></i> AI Analysis API</a></li>
                    <li><a href="#api-rag"><i class="fas fa-file-alt"></i> RAG API</a></li>
                    <li><a href="#api-database"><i class="fas fa-table"></i> Database API</a></li>
                    <li><a href="#api-eodhd"><i class="fas fa-exchange-alt"></i> EODHD API</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Advanced Topics</div>
                <ul class="sidebar-menu">
                    <li><a href="#crewai-agents"><i class="fas fa-users"></i> CrewAI Agents</a></li>
                    <li><a href="#database-schema"><i class="fas fa-project-diagram"></i> Database Schema</a></li>
                    <li><a href="#optimization-strategies"><i class="fas fa-calculator"></i> Optimization Strategies</a></li>
                    <li><a href="#risk-analytics"><i class="fas fa-shield-alt"></i> Risk Analytics</a></li>
                </ul>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">Resources</div>
                <ul class="sidebar-menu">
                    <li><a href="../contact.html"><i class="fas fa-envelope"></i> Contact</a></li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="docs-main">
            <div class="docs-content">

                <!-- OVERVIEW SECTION -->
                <section id="overview">
                    <h1>Chat with Fundamentals v2.0.0 Technical Documentation</h1>
                    <p class="docs-subtitle">Complete reference for financial research and portfolio management platform</p>

                    <div class="alert info">
                        <strong>üöÄ Research Platform:</strong> Chat with Fundamentals is a comprehensive financial research and portfolio management platform that combines AI-powered fundamental analysis with advanced quantitative portfolio optimization. Built as a research engine to explore how autonomous agents and AI can automate and enhance financial analysis.
                    </div>

                    <img src="assets/images/cwf1.png" alt="Chat with Fundamentals Overview" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>What is Chat with Fundamentals?</h3>
                    <p>Chat with Fundamentals is a full-stack financial research and portfolio management platform designed to automate and enhance financial analysis through AI-powered tools. The platform features:</p>

                    <ul>
                        <li><strong>Multi-Agent AI Analysis:</strong> Autonomous agents for analyzing stocks, ETFs, forex, and macro indicators</li>
                        <li><strong>Portfolio Management:</strong> Shares-based tracking with 5 optimization strategies (Actual, Equal Weight, MVO, Min Variance, Black-Litterman)</li>
                        <li><strong>RAG Systems:</strong> Retrieval-Augmented Generation for quant research papers and SEC filings</li>
                        <li><strong>Comprehensive Data Integration:</strong> 50+ EODHD API endpoints across 9 categories</li>
                        <li><strong>Advanced Analytics:</strong> Monte Carlo simulations, VaR, CVaR, rolling Sharpe ratios</li>
                        <li><strong>Database Management:</strong> PostgreSQL + TimescaleDB + Redis + ChromaDB architecture</li>
                        <li><strong>Real-Time Monitoring:</strong> WebSocket-based agent console for live debugging</li>
                    </ul>

                    <h3>Key Features</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><i class="fas fa-briefcase"></i> Portfolio Management</h4>
                            <ul>
                                <li>Shares-based position tracking</li>
                                <li>5 optimization strategies</li>
                                <li>Multi-asset support (stocks, ETFs, forex)</li>
                                <li>Performance attribution</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4><i class="fas fa-robot"></i> AI Analysis</h4>
                            <ul>
                                <li>4 specialized agents (fundamentals, news, price, macro)</li>
                                <li>BUY/HOLD/SELL recommendations</li>
                                <li>Real-time WebSocket logging</li>
                                <li>Agent console for debugging</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4><i class="fas fa-brain"></i> RAG Systems</h4>
                            <ul>
                                <li>Quant research paper library</li>
                                <li>SEC filings analysis (10-K, 10-Q, 8-K)</li>
                                <li>ChromaDB vector storage</li>
                                <li>OpenAI embeddings</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4><i class="fas fa-database"></i> Database Management</h4>
                            <ul>
                                <li>Fundamentals data management</li>
                                <li>Price history storage (TimescaleDB)</li>
                                <li>News aggregation</li>
                                <li>Multiple asset types</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4><i class="fas fa-calculator"></i> Risk Analytics</h4>
                            <ul>
                                <li>Monte Carlo simulations</li>
                                <li>VaR & CVaR calculations</li>
                                <li>Rolling Sharpe ratios</li>
                                <li>Correlation analysis</li>
                            </ul>
                        </div>

                        <div class="feature-card">
                            <h4><i class="fas fa-cloud-download-alt"></i> EODHD Integration</h4>
                            <ul>
                                <li>50+ API endpoints</li>
                                <li>9 data categories</li>
                                <li>Real-time & historical data</li>
                                <li>Fundamentals & financials</li>
                            </ul>
                        </div>
                    </div>

                    <img src="assets/images/cwf2.png" alt="Features Overview" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- ARCHITECTURE SECTION -->
                <section id="architecture">
                    <h2>System Architecture</h2>

                    <h3>High-Level Overview</h3>
                    <p>Chat with Fundamentals uses a modern full-stack architecture with clear separation between frontend, backend, and data layers:</p>

                    <img src="assets/images/cwf3.png" alt="System Architecture" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>Architecture Components</h3>

                    <h4>Frontend Layer (Next.js 13+)</h4>
                    <ul>
                        <li><strong>React 18:</strong> Component-based UI with hooks and context</li>
                        <li><strong>TypeScript:</strong> Type-safe development</li>
                        <li><strong>TailwindCSS:</strong> Utility-first styling</li>
                        <li><strong>shadcn/ui:</strong> Accessible component library</li>
                        <li><strong>Recharts:</strong> Financial charts and visualizations</li>
                        <li><strong>WebSocket Client:</strong> Real-time agent console updates</li>
                    </ul>

                    <h4>Backend Layer (FastAPI)</h4>
                    <ul>
                        <li><strong>FastAPI Framework:</strong> High-performance async Python API</li>
                        <li><strong>Pydantic Models:</strong> Data validation and serialization</li>
                        <li><strong>SQLAlchemy ORM:</strong> Database abstraction layer</li>
                        <li><strong>WebSocket Server:</strong> Real-time agent logging</li>
                        <li><strong>CrewAI Integration:</strong> Multi-agent orchestration</li>
                        <li><strong>LangChain:</strong> RAG pipeline and embeddings</li>
                    </ul>

                    <h4>Data Layer</h4>
                    <ul>
                        <li><strong>PostgreSQL:</strong> Primary relational database for fundamentals, portfolios, users</li>
                        <li><strong>TimescaleDB Extension:</strong> Time-series optimization for price data</li>
                        <li><strong>Redis:</strong> Caching layer for API responses and session management</li>
                        <li><strong>ChromaDB:</strong> Vector database for RAG embeddings</li>
                    </ul>

                    <h4>External Services</h4>
                    <ul>
                        <li><strong>EODHD API:</strong> Market data provider (50+ endpoints)</li>
                        <li><strong>OpenAI API:</strong> GPT models for MarketSense AI and RAG</li>
                        <li><strong>SEC EDGAR:</strong> Public filings data source</li>
                    </ul>

                    <div class="alert info">
                        <strong>üìä Database Architecture:</strong> The platform uses PostgreSQL with TimescaleDB extension for efficient time-series queries on price data. Redis provides caching to reduce API calls, while ChromaDB stores vector embeddings for semantic search in RAG systems.
                    </div>
                </section>

                <!-- INSTALLATION SECTION -->
                <section id="installation">
                    <h2>Installation & Setup</h2>

                    <h3>Prerequisites</h3>
                    <ul>
                        <li>Python 3.10+</li>
                        <li>Node.js 18+</li>
                        <li>PostgreSQL 14+</li>
                        <li>Redis 7+</li>
                        <li>Docker & Docker Compose (optional)</li>
                    </ul>

                    <h3>Backend Setup</h3>

                    <h4>1. Clone Repository & Install Dependencies</h4>
                    <pre><code># Navigate to backend directory
cd backend

# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt</code></pre>

                    <h4>2. Configure Environment Variables</h4>
                    <p>Create <code>.env</code> file in backend directory:</p>
                    <pre><code># Database
DATABASE_URL=postgresql://user:password@localhost:5432/chat_with_fundamentals
REDIS_URL=redis://localhost:6379

# API Keys
EODHD_API_KEY=your_eodhd_api_key
OPENAI_API_KEY=your_openai_api_key

# ChromaDB
CHROMA_PERSIST_DIR=./chroma_db

# Server
API_HOST=0.0.0.0
API_PORT=8000</code></pre>

                    <h4>3. Initialize Database</h4>
                    <pre><code># Run migrations
alembic upgrade head

# Create TimescaleDB hypertables
python -m app.db.init_timescale</code></pre>

                    <h4>4. Start Backend Server</h4>
                    <pre><code># Development mode with auto-reload
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Production mode
uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4</code></pre>

                    <h3>Frontend Setup</h3>

                    <h4>1. Install Dependencies</h4>
                    <pre><code># Navigate to frontend directory
cd frontend

# Install npm packages
npm install</code></pre>

                    <h4>2. Configure Environment Variables</h4>
                    <p>Create <code>.env.local</code> file in frontend directory:</p>
                    <pre><code>NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_WS_URL=ws://localhost:8000</code></pre>

                    <h4>3. Start Development Server</h4>
                    <pre><code># Development mode
npm run dev

# Build for production
npm run build

# Start production server
npm start</code></pre>

                    <h3>Docker Deployment</h3>
                    <pre><code># Build and start all services
docker-compose up -d

# View logs
docker-compose logs -f

# Stop services
docker-compose down</code></pre>

                    <div class="alert warning">
                        <strong>‚ö†Ô∏è API Keys Required:</strong> You must obtain API keys from EODHD and OpenAI before the platform can function. Free tiers are available for testing.
                    </div>
                </section>

                <!-- TECH STACK SECTION -->
                <section id="tech-stack">
                    <h2>Technology Stack</h2>

                    <h3>Frontend Technologies</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Technology</th>
                                <th>Version</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Next.js</td>
                                <td>13+</td>
                                <td>React framework with SSR and routing</td>
                            </tr>
                            <tr>
                                <td>React</td>
                                <td>18</td>
                                <td>UI component library</td>
                            </tr>
                            <tr>
                                <td>TypeScript</td>
                                <td>5</td>
                                <td>Type-safe JavaScript</td>
                            </tr>
                            <tr>
                                <td>TailwindCSS</td>
                                <td>3</td>
                                <td>Utility-first CSS framework</td>
                            </tr>
                            <tr>
                                <td>shadcn/ui</td>
                                <td>Latest</td>
                                <td>Accessible component library</td>
                            </tr>
                            <tr>
                                <td>Recharts</td>
                                <td>2</td>
                                <td>Chart library for data visualization</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Backend Technologies</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Technology</th>
                                <th>Version</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>FastAPI</td>
                                <td>0.104+</td>
                                <td>High-performance async web framework</td>
                            </tr>
                            <tr>
                                <td>Python</td>
                                <td>3.10+</td>
                                <td>Backend programming language</td>
                            </tr>
                            <tr>
                                <td>SQLAlchemy</td>
                                <td>2.0</td>
                                <td>ORM for database operations</td>
                            </tr>
                            <tr>
                                <td>Pydantic</td>
                                <td>2.0</td>
                                <td>Data validation and serialization</td>
                            </tr>
                            <tr>
                                <td>CrewAI</td>
                                <td>Latest</td>
                                <td>Multi-agent orchestration framework</td>
                            </tr>
                            <tr>
                                <td>LangChain</td>
                                <td>Latest</td>
                                <td>RAG pipeline and embeddings</td>
                            </tr>
                            <tr>
                                <td>PyPortfolioOpt</td>
                                <td>1.5+</td>
                                <td>Portfolio optimization algorithms</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Database & Storage</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Technology</th>
                                <th>Version</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>PostgreSQL</td>
                                <td>14+</td>
                                <td>Primary relational database</td>
                            </tr>
                            <tr>
                                <td>TimescaleDB</td>
                                <td>2.11+</td>
                                <td>Time-series extension for price data</td>
                            </tr>
                            <tr>
                                <td>Redis</td>
                                <td>7+</td>
                                <td>Caching and session management</td>
                            </tr>
                            <tr>
                                <td>ChromaDB</td>
                                <td>Latest</td>
                                <td>Vector database for RAG embeddings</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>External APIs</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>EODHD API</td>
                                <td>Market data, fundamentals, financials</td>
                            </tr>
                            <tr>
                                <td>OpenAI API</td>
                                <td>GPT models for AI analysis and embeddings</td>
                            </tr>
                            <tr>
                                <td>SEC EDGAR</td>
                                <td>Public company filings</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- PORTFOLIO MANAGEMENT SECTION -->
                <section id="portfolio-management">
                    <h2>Portfolio Management</h2>

                    <img src="assets/images/cwf_portfolio_optimization.png" alt="Portfolio Optimization" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>Overview</h3>
                    <p>The Portfolio Management module provides comprehensive tools for tracking and optimizing investment portfolios with shares-based position tracking and advanced optimization strategies.</p>

                    <h3>Core Features</h3>
                    <ul>
                        <li><strong>Shares-Based Tracking:</strong> Track positions by number of shares (not just dollar amounts)</li>
                        <li><strong>5 Optimization Strategies:</strong> Actual, Equal Weight, MVO, Min Variance, Black-Litterman</li>
                        <li><strong>Multi-Asset Support:</strong> Stocks, ETFs, forex pairs</li>
                        <li><strong>Performance Attribution:</strong> Analyze returns by position and time period</li>
                        <li><strong>Real-Time Updates:</strong> Live portfolio value updates based on market prices</li>
                        <li><strong>Historical Tracking:</strong> Daily snapshots for performance analysis</li>
                    </ul>

                    <h3>Optimization Strategies</h3>

                    <h4>1. Actual Portfolio</h4>
                    <p>Your current holdings as entered in the system, reflecting your real investment positions.</p>

                    <h4>2. Equal Weight</h4>
                    <p>Allocates portfolio value equally across all positions:</p>
                    <pre><code>weight_i = 1 / N
where N = number of positions</code></pre>

                    <h4>3. Mean-Variance Optimization (MVO)</h4>
                    <p>Maximizes Sharpe ratio using historical returns and covariance:</p>
                    <pre><code>max w^T Œº - Œª/2 w^T Œ£ w
subject to: w^T 1 = 1, w ‚â• 0
where:
  w = portfolio weights
  Œº = expected returns
  Œ£ = covariance matrix
  Œª = risk aversion parameter</code></pre>

                    <h4>4. Minimum Variance</h4>
                    <p>Minimizes portfolio volatility regardless of expected returns:</p>
                    <pre><code>min w^T Œ£ w
subject to: w^T 1 = 1, w ‚â• 0</code></pre>

                    <h4>5. Black-Litterman</h4>
                    <p>Combines market equilibrium with investor views:</p>
                    <pre><code>E[R] = [(œÑŒ£)^-1 + P^T Œ©^-1 P]^-1 [(œÑŒ£)^-1 Œ† + P^T Œ©^-1 Q]
where:
  Œ† = market equilibrium returns
  P = view matrix
  Q = view returns
  Œ© = view uncertainty
  œÑ = scaling factor</code></pre>

                    <img src="assets/images/cwf_return_distribution.png" alt="Return Distribution Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>API Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/portfolio/current</span>
                        <p class="endpoint-description">Get current portfolio positions with real-time prices</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:45-78</code></p>
                        <pre><code># Response
{
  "positions": [
    {
      "symbol": "AAPL",
      "shares": 100,
      "avg_cost": 150.25,
      "current_price": 175.50,
      "market_value": 17550.00,
      "unrealized_pnl": 2525.00,
      "unrealized_pnl_pct": 16.81
    }
  ],
  "total_value": 125000.00,
  "total_cost": 100000.00,
  "total_pnl": 25000.00
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/portfolio/optimize</span>
                        <p class="endpoint-description">Optimize portfolio using selected strategy</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:125-189</code></p>
                        <pre><code># Request
{
  "strategy": "mvo",  // actual | equal_weight | mvo | min_variance | black_litterman
  "risk_free_rate": 0.045,
  "lookback_days": 252
}

# Response
{
  "strategy": "mvo",
  "weights": {
    "AAPL": 0.25,
    "MSFT": 0.30,
    "GOOGL": 0.20,
    "AMZN": 0.25
  },
  "metrics": {
    "expected_return": 0.185,
    "volatility": 0.142,
    "sharpe_ratio": 0.98
  }
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/portfolio/positions</span>
                        <p class="endpoint-description">Add or update portfolio position</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:80-123</code></p>
                        <pre><code># Request
{
  "symbol": "AAPL",
  "shares": 100,
  "avg_cost": 150.25,
  "transaction_date": "2025-01-15"
}

# Response
{
  "position_id": 123,
  "symbol": "AAPL",
  "shares": 100,
  "avg_cost": 150.25
}</code></pre>
                    </div>

                    <img src="assets/images/cwf_sharpe.png" alt="Sharpe Ratio Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- AI ANALYSIS SECTION -->
                <section id="ai-analysis">
                    <h2>AI Analysis</h2>

                    <img src="assets/images/cwf_ai_analysis.png" alt="AI Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>Overview</h3>
                    <p>The AI Analysis module is a multi-agent system built with CrewAI that provides comprehensive stock analysis through four specialized agents. Inspired by multi-agent frameworks for financial analysis.</p>

                    <h3>Agent Architecture</h3>

                    <h4>1. Fundamentals Agent</h4>
                    <ul>
                        <li><strong>Role:</strong> Analyzes company financials and fundamentals</li>
                        <li><strong>Data Sources:</strong> Income statements, balance sheets, cash flow statements</li>
                        <li><strong>Metrics:</strong> P/E ratio, debt-to-equity, profit margins, revenue growth</li>
                        <li><strong>Output:</strong> Fundamental strength score (1-10)</li>
                    </ul>

                    <img src="assets/images/cwf_fundamentals.png" alt="Fundamentals Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h4>2. News Agent</h4>
                    <ul>
                        <li><strong>Role:</strong> Analyzes recent news sentiment and major events</li>
                        <li><strong>Data Sources:</strong> Financial news, press releases, earnings calls</li>
                        <li><strong>Analysis:</strong> Sentiment analysis, event impact assessment</li>
                        <li><strong>Output:</strong> News sentiment score (-10 to +10)</li>
                    </ul>

                    <h4>3. Price Agent</h4>
                    <ul>
                        <li><strong>Role:</strong> Technical analysis and price pattern recognition</li>
                        <li><strong>Data Sources:</strong> Historical prices, volume, technical indicators</li>
                        <li><strong>Analysis:</strong> Trend identification, support/resistance, momentum</li>
                        <li><strong>Output:</strong> Technical score (1-10)</li>
                    </ul>

                    <h4>4. Macro Agent</h4>
                    <ul>
                        <li><strong>Role:</strong> Analyzes macroeconomic environment and sector trends</li>
                        <li><strong>Data Sources:</strong> Economic indicators, sector performance, market conditions</li>
                        <li><strong>Analysis:</strong> Interest rates, GDP growth, sector rotation</li>
                        <li><strong>Output:</strong> Macro environment score (1-10)</li>
                    </ul>

                    <img src="assets/images/cwf_macro.png" alt="Macro Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>Final Recommendation</h3>
                    <p>A Portfolio Manager agent synthesizes all agent outputs to generate:</p>
                    <ul>
                        <li><strong>Signal:</strong> BUY / HOLD / SELL</li>
                        <li><strong>Conviction:</strong> 1-10 score indicating confidence level</li>
                        <li><strong>Reasoning:</strong> Detailed explanation of recommendation</li>
                        <li><strong>Risk Factors:</strong> Key risks to monitor</li>
                    </ul>

                    <h3>Agent Console</h3>
                    <p>Real-time WebSocket-based debugging console showing agent thought processes:</p>
                    <ul>
                        <li>Live agent status updates</li>
                        <li>Task execution logs</li>
                        <li>Tool usage tracking</li>
                        <li>Error messages and warnings</li>
                    </ul>

                    <div class="alert info">
                        <strong>ü§ñ Agent Workflow:</strong> Agents run in parallel to maximize speed, then converge for the final recommendation. The entire analysis typically completes in 30-60 seconds.
                    </div>

                    <h3>API Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/ai-analysis/analyze</span>
                        <p class="endpoint-description">Run AI analysis on a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/marketsense.py:34-112</code></p>
                        <pre><code># Request
{
  "symbol": "AAPL",
  "analysis_type": "stock",  // stock | etf | forex | macro
  "llm_provider": "openai"   // openai | anthropic
}

# Response
{
  "symbol": "AAPL",
  "timestamp": "2025-01-15T10:30:00Z",
  "signal": "BUY",
  "conviction": 8,
  "agent_scores": {
    "fundamentals": 9,
    "news": 7,
    "price": 8,
    "macro": 7
  },
  "reasoning": "Strong fundamentals with positive earnings surprise...",
  "risk_factors": ["Regulatory concerns", "Valuation metrics"],
  "execution_time_seconds": 45.2
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/ai-analysis/ws</span>
                        <p class="endpoint-description">WebSocket endpoint for real-time agent console</p>
                        <p><strong>Source:</strong> <code>backend/app/api/websocket.py:23-67</code></p>
                        <pre><code># WebSocket Messages
{
  "event": "agent_status",
  "agent": "fundamentals",
  "status": "running",
  "message": "Analyzing financial statements..."
}

{
  "event": "task_complete",
  "agent": "news",
  "output": "Positive sentiment from recent earnings call"
}

{
  "event": "final_recommendation",
  "signal": "BUY",
  "conviction": 8
}</code></pre>
                    </div>
                </section>

                <!-- RAG SYSTEMS SECTION -->
                <section id="rag-systems">
                    <h2>RAG Systems</h2>

                    <img src="assets/images/cwf_quant_rag.png" alt="Quant Research RAG" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h3>Overview</h3>
                    <p>Chat with Fundamentals includes two Retrieval-Augmented Generation (RAG) systems for querying quantitative research papers and SEC filings using natural language.</p>

                    <h3>1. Quant Research Library RAG</h3>
                    <p>Semantic search over a curated library of quantitative finance research papers.</p>

                    <h4>Features</h4>
                    <ul>
                        <li><strong>Paper Collection:</strong> 500+ academic papers on quant strategies, risk management, portfolio optimization</li>
                        <li><strong>Semantic Search:</strong> Find relevant papers using natural language queries</li>
                        <li><strong>Citation Tracking:</strong> Automatically includes paper titles, authors, years</li>
                        <li><strong>Context Retrieval:</strong> Returns relevant sections with page numbers</li>
                    </ul>

                    <h4>Implementation</h4>
                    <ul>
                        <li><strong>Vector Store:</strong> ChromaDB</li>
                        <li><strong>Embeddings:</strong> OpenAI text-embedding-3-small</li>
                        <li><strong>Chunking:</strong> ~1000 tokens with 200-token overlap</li>
                        <li><strong>Retrieval:</strong> Top-k similarity search (k=5)</li>
                    </ul>

                    <h3>2. SEC Filings RAG</h3>
                    <p>Query company SEC filings (10-K, 10-Q, 8-K) using natural language.</p>

                    <img src="assets/images/cwf_sec_filings.png" alt="SEC Filings RAG" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h4>Features</h4>
                    <ul>
                        <li><strong>Filing Types:</strong> 10-K (annual), 10-Q (quarterly), 8-K (current events)</li>
                        <li><strong>Company Coverage:</strong> All public US companies</li>
                        <li><strong>Historical Data:</strong> Filings from 2020-present</li>
                        <li><strong>Section Extraction:</strong> Automatically parses standard SEC sections</li>
                    </ul>

                    <h4>Common Queries</h4>
                    <ul>
                        <li>"What are the key risk factors for AAPL?"</li>
                        <li>"Summarize MSFT's revenue breakdown by segment"</li>
                        <li>"What did TSLA say about production capacity in their latest 10-Q?"</li>
                        <li>"Compare GOOGL's R&D spending over the last 3 years"</li>
                    </ul>

                    <h3>RAG Pipeline</h3>
                    <pre><code>1. User Query ‚Üí Embedding
2. Vector Search ‚Üí Retrieve Top-k Chunks
3. Context + Query ‚Üí LLM (GPT-4)
4. LLM Response ‚Üí Citation Formatting
5. Return Answer with Sources</code></pre>

                    <div class="alert info">
                        <strong>üí° RAG Benefits:</strong> RAG systems provide accurate, citation-backed answers by grounding LLM responses in actual document content, reducing hallucinations and improving reliability.
                    </div>

                    <h3>API Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/rag/quant-research</span>
                        <p class="endpoint-description">Query quantitative research paper library</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:45-98</code></p>
                        <pre><code># Request
{
  "query": "What are the best momentum strategies for equity markets?",
  "top_k": 5
}

# Response
{
  "answer": "Based on the research papers, the most effective momentum strategies...",
  "sources": [
    {
      "title": "Momentum Strategies in Equity Markets",
      "authors": ["Smith, J.", "Doe, A."],
      "year": 2022,
      "page": 15,
      "excerpt": "...relevant text..."
    }
  ],
  "execution_time_seconds": 2.3
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/rag/sec-filings</span>
                        <p class="endpoint-description">Query SEC filings for specific companies</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:100-156</code></p>
                        <pre><code># Request
{
  "symbol": "AAPL",
  "query": "What are the main risk factors?",
  "filing_types": ["10-K", "10-Q"],
  "years": [2023, 2024]
}

# Response
{
  "answer": "Apple's main risk factors include...",
  "sources": [
    {
      "symbol": "AAPL",
      "filing_type": "10-K",
      "filing_date": "2024-11-03",
      "section": "Risk Factors",
      "page": 8,
      "excerpt": "...relevant text..."
    }
  ]
}</code></pre>
                    </div>

                    <img src="assets/images/cwf_deep_research.png" alt="Deep Research" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- DATABASE MANAGEMENT SECTION -->
                <section id="database-management">
                    <h2>Database Management</h2>

                    <h3>Overview</h3>
                    <p>The Database Management module provides comprehensive tools for managing fundamentals data, price history, and news across multiple asset types (stocks, ETFs, forex).</p>

                    <h3>Core Features</h3>
                    <ul>
                        <li><strong>Fundamentals Management:</strong> Store and retrieve company financial data</li>
                        <li><strong>Price History:</strong> TimescaleDB-optimized time-series storage</li>
                        <li><strong>News Aggregation:</strong> Store and search financial news articles</li>
                        <li><strong>Multi-Asset Support:</strong> Stocks, ETFs, forex pairs, macro indicators</li>
                        <li><strong>Data Validation:</strong> Automatic validation and cleaning</li>
                        <li><strong>Bulk Operations:</strong> Efficient batch updates</li>
                    </ul>

                    <h3>Database Schema Highlights</h3>

                    <h4>Fundamentals Table</h4>
                    <pre><code>fundamentals (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(20) NOT NULL,
  market_cap BIGINT,
  pe_ratio FLOAT,
  forward_pe FLOAT,
  peg_ratio FLOAT,
  price_to_book FLOAT,
  debt_to_equity FLOAT,
  roe FLOAT,
  dividend_yield FLOAT,
  eps FLOAT,
  revenue BIGINT,
  net_income BIGINT,
  sector VARCHAR(100),
  industry VARCHAR(100),
  last_updated TIMESTAMP,
  UNIQUE(symbol)
)</code></pre>

                    <h4>Price History (TimescaleDB Hypertable)</h4>
                    <pre><code>price_history (
  time TIMESTAMP NOT NULL,
  symbol VARCHAR(20) NOT NULL,
  open FLOAT,
  high FLOAT,
  low FLOAT,
  close FLOAT,
  volume BIGINT,
  adjusted_close FLOAT,
  PRIMARY KEY (time, symbol)
)
-- Hypertable partitioned by time</code></pre>

                    <h4>News Articles</h4>
                    <pre><code>news_articles (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(20),
  title TEXT,
  content TEXT,
  source VARCHAR(200),
  published_at TIMESTAMP,
  sentiment FLOAT,
  url TEXT,
  FOREIGN KEY (symbol) REFERENCES symbols(symbol)
)</code></pre>

                    <h3>API Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/fundamentals/{symbol}</span>
                        <p class="endpoint-description">Get fundamentals data for a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:34-67</code></p>
                        <pre><code># Response
{
  "symbol": "AAPL",
  "market_cap": 2850000000000,
  "pe_ratio": 28.5,
  "forward_pe": 25.2,
  "peg_ratio": 2.1,
  "price_to_book": 42.3,
  "debt_to_equity": 1.73,
  "roe": 0.147,
  "dividend_yield": 0.0052,
  "eps": 6.15,
  "revenue": 383285000000,
  "net_income": 96995000000,
  "sector": "Technology",
  "industry": "Consumer Electronics",
  "last_updated": "2025-01-15T09:00:00Z"
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/database/fundamentals/update</span>
                        <p class="endpoint-description">Update fundamentals data (single or bulk)</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:69-115</code></p>
                        <pre><code># Request (single)
{
  "symbol": "AAPL",
  "data": {
    "market_cap": 2850000000000,
    "pe_ratio": 28.5,
    ...
  }
}

# Request (bulk)
{
  "symbols": ["AAPL", "MSFT", "GOOGL"],
  "fetch_from_eodhd": true
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/prices/{symbol}</span>
                        <p class="endpoint-description">Get price history for a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:117-165</code></p>
                        <pre><code># Query Parameters
?start_date=2024-01-01&end_date=2024-12-31&interval=daily

# Response
{
  "symbol": "AAPL",
  "prices": [
    {
      "time": "2024-01-02T00:00:00Z",
      "open": 185.64,
      "high": 187.02,
      "low": 182.16,
      "close": 184.25,
      "volume": 82488500,
      "adjusted_close": 184.25
    }
  ]
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/news/{symbol}</span>
                        <p class="endpoint-description">Get news articles for a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:167-205</code></p>
                        <pre><code># Query Parameters
?limit=20&offset=0&days=30

# Response
{
  "symbol": "AAPL",
  "total_count": 156,
  "articles": [
    {
      "id": 12345,
      "title": "Apple announces new product line",
      "content": "...",
      "source": "Reuters",
      "published_at": "2025-01-15T08:00:00Z",
      "sentiment": 0.75,
      "url": "https://..."
    }
  ]
}</code></pre>
                    </div>
                </section>

                <!-- EODHD DATA API SECTION -->
                <section id="data-api">
                    <h2>EODHD Data API Integration</h2>

                    <h3>Overview</h3>
                    <p>Chat with Fundamentals integrates with EODHD (End of Day Historical Data) API to provide comprehensive financial market data. The platform wraps 50+ EODHD endpoints across 9 categories.</p>

                    <h3>API Categories</h3>

                    <h4>1. Market Data (7 endpoints)</h4>
                    <ul>
                        <li>Real-time quotes</li>
                        <li>Historical EOD prices</li>
                        <li>Intraday data</li>
                        <li>Live prices</li>
                        <li>Technical indicators</li>
                    </ul>

                    <h4>2. Fundamentals (12 endpoints)</h4>
                    <ul>
                        <li>Company fundamentals</li>
                        <li>Financial statements (income, balance sheet, cash flow)</li>
                        <li>Earnings history</li>
                        <li>Analyst recommendations</li>
                        <li>Insider transactions</li>
                    </ul>

                    <h4>3. Calendar Data (5 endpoints)</h4>
                    <ul>
                        <li>Earnings calendar</li>
                        <li>IPO calendar</li>
                        <li>Splits calendar</li>
                        <li>Dividends calendar</li>
                    </ul>

                    <h4>4. News (3 endpoints)</h4>
                    <ul>
                        <li>Financial news by symbol</li>
                        <li>General market news</li>
                        <li>Sentiment analysis</li>
                    </ul>

                    <h4>5. ETF Data (6 endpoints)</h4>
                    <ul>
                        <li>ETF fundamentals</li>
                        <li>Holdings data</li>
                        <li>Sector allocations</li>
                        <li>Performance metrics</li>
                    </ul>

                    <h4>6. Forex & Crypto (4 endpoints)</h4>
                    <ul>
                        <li>Currency exchange rates</li>
                        <li>Cryptocurrency prices</li>
                        <li>Historical forex data</li>
                    </ul>

                    <h4>7. Macro Indicators (8 endpoints)</h4>
                    <ul>
                        <li>GDP data</li>
                        <li>Inflation rates</li>
                        <li>Interest rates</li>
                        <li>Employment data</li>
                        <li>Consumer confidence</li>
                    </ul>

                    <img src="assets/images/cwf_forex.png" alt="Forex Data" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <h4>8. Options (3 endpoints)</h4>
                    <ul>
                        <li>Options chain data</li>
                        <li>Historical options prices</li>
                        <li>Implied volatility</li>
                    </ul>

                    <h4>9. Screener & Search (2 endpoints)</h4>
                    <ul>
                        <li>Stock screener</li>
                        <li>Symbol search</li>
                    </ul>

                    <h3>API Wrapper Implementation</h3>
                    <p>All EODHD endpoints are wrapped in a unified FastAPI interface with:</p>
                    <ul>
                        <li><strong>Caching:</strong> Redis caching to reduce API calls</li>
                        <li><strong>Rate Limiting:</strong> Automatic rate limit handling</li>
                        <li><strong>Error Handling:</strong> Graceful degradation on API errors</li>
                        <li><strong>Data Validation:</strong> Pydantic models for all responses</li>
                        <li><strong>Batch Operations:</strong> Efficient multi-symbol requests</li>
                    </ul>

                    <h3>Example API Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/quote/{symbol}</span>
                        <p class="endpoint-description">Get real-time quote for a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:45-78</code></p>
                        <pre><code># Response
{
  "code": "AAPL.US",
  "timestamp": 1705324800,
  "close": 185.64,
  "high": 187.02,
  "low": 182.16,
  "open": 182.15,
  "volume": 82488500,
  "previousClose": 181.18,
  "change": 4.46,
  "change_p": 2.46
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/fundamentals/{symbol}</span>
                        <p class="endpoint-description">Get company fundamentals</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:80-145</code></p>
                        <pre><code># Response (partial - very large object)
{
  "General": {
    "Code": "AAPL",
    "Name": "Apple Inc",
    "Exchange": "US",
    "Sector": "Technology",
    "Industry": "Consumer Electronics",
    "MarketCapitalization": 2850000000000
  },
  "Highlights": {
    "MarketCapitalization": 2850000000000,
    "EBITDA": 130541000000,
    "PERatio": 28.51,
    "PEGRatio": 2.14,
    ...
  },
  "Valuation": {...},
  "Financials": {
    "Balance_Sheet": {...},
    "Income_Statement": {...},
    "Cash_Flow": {...}
  }
}</code></pre>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/calendar/earnings</span>
                        <p class="endpoint-description">Get upcoming earnings calendar</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:235-278</code></p>
                        <pre><code># Query Parameters
?from=2025-01-15&to=2025-01-22

# Response
{
  "earnings": [
    {
      "code": "AAPL.US",
      "report_date": "2025-01-18",
      "date": "2025-01-18",
      "before_after_market": "AfterMarket",
      "currency": "USD",
      "estimate": "2.10",
      "actual": null
    }
  ]
}</code></pre>
                    </div>

                    <img src="assets/images/cwf_openbb.png" alt="OpenBB Integration" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">

                    <div class="alert warning">
                        <strong>‚ö†Ô∏è API Rate Limits:</strong> EODHD API has rate limits based on subscription tier. The platform automatically caches responses and implements exponential backoff to stay within limits.
                    </div>
                </section>

                <!-- API OVERVIEW SECTION -->
                <section id="api-overview">
                    <h2>API Reference Overview</h2>

                    <h3>Base URL</h3>
                    <pre><code>http://localhost:8000/api</code></pre>

                    <h3>Authentication</h3>
                    <p>All API endpoints require authentication via JWT token in the Authorization header:</p>
                    <pre><code>Authorization: Bearer &lt;jwt_token&gt;</code></pre>

                    <h3>Rate Limiting</h3>
                    <p>API endpoints are rate-limited to prevent abuse:</p>
                    <ul>
                        <li><strong>Authenticated users:</strong> 100 requests per minute</li>
                        <li><strong>Unauthenticated:</strong> 10 requests per minute</li>
                    </ul>

                    <h3>Response Format</h3>
                    <p>All responses follow a consistent JSON structure:</p>
                    <pre><code>{
  "data": {...},           // Response data
  "error": null,           // Error message (if any)
  "timestamp": "...",      // ISO 8601 timestamp
  "execution_time": 0.123  // Execution time in seconds
}</code></pre>

                    <h3>Error Handling</h3>
                    <p>Errors return appropriate HTTP status codes with detailed messages:</p>
                    <pre><code>{
  "data": null,
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Invalid symbol format",
    "details": {...}
  },
  "timestamp": "2025-01-15T10:30:00Z"
}</code></pre>

                    <h3>Common HTTP Status Codes</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Meaning</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>200</td>
                                <td>OK - Request successful</td>
                            </tr>
                            <tr>
                                <td>201</td>
                                <td>Created - Resource created successfully</td>
                            </tr>
                            <tr>
                                <td>400</td>
                                <td>Bad Request - Invalid input</td>
                            </tr>
                            <tr>
                                <td>401</td>
                                <td>Unauthorized - Authentication required</td>
                            </tr>
                            <tr>
                                <td>403</td>
                                <td>Forbidden - Insufficient permissions</td>
                            </tr>
                            <tr>
                                <td>404</td>
                                <td>Not Found - Resource not found</td>
                            </tr>
                            <tr>
                                <td>429</td>
                                <td>Too Many Requests - Rate limit exceeded</td>
                            </tr>
                            <tr>
                                <td>500</td>
                                <td>Internal Server Error - Server error</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- PORTFOLIO API SECTION -->
                <section id="api-portfolio">
                    <h2>Portfolio API</h2>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/portfolio/current</span>
                        <p class="endpoint-description">Get current portfolio with live prices</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:45-78</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/portfolio/positions</span>
                        <p class="endpoint-description">Add or update position</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:80-123</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-delete">DELETE</span>
                        <span class="endpoint-path">/api/portfolio/positions/{position_id}</span>
                        <p class="endpoint-description">Delete a position</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:191-212</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/portfolio/optimize</span>
                        <p class="endpoint-description">Run portfolio optimization</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:125-189</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/portfolio/performance</span>
                        <p class="endpoint-description">Get portfolio performance metrics</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:214-267</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/portfolio/history</span>
                        <p class="endpoint-description">Get historical portfolio snapshots</p>
                        <p><strong>Source:</strong> <code>backend/app/api/portfolio.py:269-312</code></p>
                    </div>

                    <img src="assets/images/cwf_pair_trading.png" alt="Pair Trading Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- AI ANALYSIS API SECTION -->
                <section id="api-ai-analysis">
                    <h2>AI Analysis API</h2>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/ai-analysis/analyze</span>
                        <p class="endpoint-description">Run AI analysis</p>
                        <p><strong>Source:</strong> <code>backend/app/api/marketsense.py:34-112</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/ai-analysis/history/{symbol}</span>
                        <p class="endpoint-description">Get historical analyses for a symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/marketsense.py:114-156</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/ai-analysis/ws</span>
                        <p class="endpoint-description">WebSocket endpoint for agent console</p>
                        <p><strong>Source:</strong> <code>backend/app/api/websocket.py:23-67</code></p>
                    </div>
                </section>

                <!-- RAG API SECTION -->
                <section id="api-rag">
                    <h2>RAG API</h2>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/rag/quant-research</span>
                        <p class="endpoint-description">Query quant research library</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:45-98</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/rag/sec-filings</span>
                        <p class="endpoint-description">Query SEC filings</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:100-156</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/rag/papers</span>
                        <p class="endpoint-description">List available research papers</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:158-189</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/rag/index-paper</span>
                        <p class="endpoint-description">Index a new research paper</p>
                        <p><strong>Source:</strong> <code>backend/app/api/rag.py:191-234</code></p>
                    </div>
                </section>

                <!-- DATABASE API SECTION -->
                <section id="api-database">
                    <h2>Database API</h2>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/fundamentals/{symbol}</span>
                        <p class="endpoint-description">Get fundamentals data</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:34-67</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/database/fundamentals/update</span>
                        <p class="endpoint-description">Update fundamentals (single or bulk)</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:69-115</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/prices/{symbol}</span>
                        <p class="endpoint-description">Get price history</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:117-165</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/database/prices/update</span>
                        <p class="endpoint-description">Update price history</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:207-256</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/database/news/{symbol}</span>
                        <p class="endpoint-description">Get news articles</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:167-205</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-path">/api/database/news/update</span>
                        <p class="endpoint-description">Update news articles</p>
                        <p><strong>Source:</strong> <code>backend/app/api/database.py:258-301</code></p>
                    </div>
                </section>

                <!-- EODHD API SECTION -->
                <section id="api-eodhd">
                    <h2>EODHD API</h2>
                    <p>All EODHD endpoints are wrapped under <code>/api/eodhd/*</code> with caching and rate limiting.</p>

                    <h3>Market Data Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/quote/{symbol}</span>
                        <p class="endpoint-description">Real-time quote</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:45-78</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/eod/{symbol}</span>
                        <p class="endpoint-description">Historical end-of-day prices</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:80-125</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/intraday/{symbol}</span>
                        <p class="endpoint-description">Intraday prices (1min/5min/1h intervals)</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:127-178</code></p>
                    </div>

                    <h3>Fundamentals Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/fundamentals/{symbol}</span>
                        <p class="endpoint-description">Company fundamentals</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:180-245</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/financials/{symbol}</span>
                        <p class="endpoint-description">Financial statements</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:247-298</code></p>
                    </div>

                    <h3>Calendar Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/calendar/earnings</span>
                        <p class="endpoint-description">Earnings calendar</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:235-278</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/calendar/ipos</span>
                        <p class="endpoint-description">IPO calendar</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:280-315</code></p>
                    </div>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/calendar/splits</span>
                        <p class="endpoint-description">Stock splits calendar</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:317-352</code></p>
                    </div>

                    <h3>News Endpoints</h3>

                    <div class="endpoint">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-path">/api/eodhd/news/{symbol}</span>
                        <p class="endpoint-description">News articles for symbol</p>
                        <p><strong>Source:</strong> <code>backend/app/api/eodhd.py:354-389</code></p>
                    </div>

                    <p><em>See full EODHD API documentation for all 50+ available endpoints.</em></p>
                </section>

                <!-- CREWAI AGENTS SECTION -->
                <section id="crewai-agents">
                    <h2>CrewAI Agent Framework</h2>

                    <h3>Overview</h3>
                    <p>Chat with Fundamentals uses CrewAI for multi-agent orchestration in the AI Analysis system. CrewAI provides role-based agent collaboration with task delegation and tool sharing.</p>

                    <h3>Agent Configuration</h3>

                    <h4>Agent Structure</h4>
                    <pre><code>from crewai import Agent, Task, Crew

# Define agent
agent = Agent(
    role="Fundamentals Analyst",
    goal="Analyze company financial statements",
    backstory="Expert financial analyst with 15 years experience...",
    tools=[fundamentals_tool, financial_statements_tool],
    llm=ChatOpenAI(model="gpt-4"),
    verbose=True
)</code></pre>

                    <h4>Task Definition</h4>
                    <pre><code>task = Task(
    description="Analyze AAPL financial statements and rate 1-10",
    agent=fundamentals_agent,
    expected_output="Numerical score with brief reasoning"
)</code></pre>

                    <h4>Crew Orchestration</h4>
                    <pre><code>crew = Crew(
    agents=[fundamentals_agent, news_agent, price_agent, macro_agent],
    tasks=[fund_task, news_task, price_task, macro_task],
    process=Process.parallel  # Run agents in parallel
)

result = crew.kickoff()</code></pre>

                    <h3>Custom Tools</h3>
                    <p>Agents have access to custom tools for data retrieval:</p>

                    <h4>Fundamentals Tool</h4>
                    <pre><code>@tool("Get Fundamentals")
def get_fundamentals(symbol: str) -> dict:
    """Get company fundamentals from database"""
    return fetch_fundamentals_from_db(symbol)</code></pre>

                    <h4>News Tool</h4>
                    <pre><code>@tool("Get News")
def get_news(symbol: str, days: int = 30) -> list:
    """Get recent news articles for symbol"""
    return fetch_news_from_db(symbol, days)</code></pre>

                    <h4>Price Tool</h4>
                    <pre><code>@tool("Get Price History")
def get_price_history(symbol: str, days: int = 365) -> list:
    """Get historical price data"""
    return fetch_prices_from_db(symbol, days)</code></pre>

                    <h3>WebSocket Logging</h3>
                    <p>All agent activities are logged via WebSocket for real-time monitoring:</p>
                    <pre><code>class WebSocketLogger:
    async def log_agent_status(self, agent_name, status, message):
        await self.ws.send_json({
            "event": "agent_status",
            "agent": agent_name,
            "status": status,
            "message": message,
            "timestamp": datetime.now().isoformat()
        })

    async def log_task_complete(self, agent_name, output):
        await self.ws.send_json({
            "event": "task_complete",
            "agent": agent_name,
            "output": output
        })</code></pre>

                    <div class="alert info">
                        <strong>ü§ñ Agent Collaboration:</strong> CrewAI enables agents to share insights and collaborate on complex analysis tasks, resulting in more comprehensive and accurate recommendations.
                    </div>
                </section>

                <!-- DATABASE SCHEMA SECTION -->
                <section id="database-schema">
                    <h2>Database Schema</h2>

                    <h3>Entity Relationship Overview</h3>
                    <p>The database schema is designed around five core entities: Users, Portfolios, Symbols, Fundamentals, and Prices.</p>

                    <h3>Core Tables</h3>

                    <h4>Users</h4>
                    <pre><code>users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  hashed_password VARCHAR(255) NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  last_login TIMESTAMP,
  is_active BOOLEAN DEFAULT TRUE
)</code></pre>

                    <h4>Portfolios</h4>
                    <pre><code>portfolios (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  name VARCHAR(200) NOT NULL,
  description TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, name)
)</code></pre>

                    <h4>Positions</h4>
                    <pre><code>positions (
  id SERIAL PRIMARY KEY,
  portfolio_id INTEGER REFERENCES portfolios(id) ON DELETE CASCADE,
  symbol VARCHAR(20) NOT NULL,
  shares FLOAT NOT NULL,
  avg_cost FLOAT NOT NULL,
  transaction_date DATE NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
)</code></pre>

                    <h4>Symbols</h4>
                    <pre><code>symbols (
  symbol VARCHAR(20) PRIMARY KEY,
  name VARCHAR(200),
  exchange VARCHAR(50),
  asset_type VARCHAR(50),  -- stock | etf | forex | crypto
  sector VARCHAR(100),
  industry VARCHAR(100),
  country VARCHAR(50),
  currency VARCHAR(10),
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW()
)</code></pre>

                    <h4>Fundamentals</h4>
                    <pre><code>fundamentals (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(20) REFERENCES symbols(symbol),
  market_cap BIGINT,
  pe_ratio FLOAT,
  forward_pe FLOAT,
  peg_ratio FLOAT,
  price_to_book FLOAT,
  price_to_sales FLOAT,
  debt_to_equity FLOAT,
  current_ratio FLOAT,
  quick_ratio FLOAT,
  roe FLOAT,
  roa FLOAT,
  profit_margin FLOAT,
  operating_margin FLOAT,
  dividend_yield FLOAT,
  eps FLOAT,
  revenue BIGINT,
  net_income BIGINT,
  ebitda BIGINT,
  free_cash_flow BIGINT,
  last_updated TIMESTAMP DEFAULT NOW(),
  UNIQUE(symbol)
)</code></pre>

                    <h4>Price History (TimescaleDB Hypertable)</h4>
                    <pre><code>price_history (
  time TIMESTAMP NOT NULL,
  symbol VARCHAR(20) NOT NULL,
  open FLOAT,
  high FLOAT,
  low FLOAT,
  close FLOAT,
  volume BIGINT,
  adjusted_close FLOAT,
  PRIMARY KEY (time, symbol)
);

-- Convert to hypertable for time-series optimization
SELECT create_hypertable('price_history', 'time');</code></pre>

                    <h4>News Articles</h4>
                    <pre><code>news_articles (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(20) REFERENCES symbols(symbol),
  title TEXT NOT NULL,
  content TEXT,
  source VARCHAR(200),
  author VARCHAR(200),
  published_at TIMESTAMP NOT NULL,
  sentiment FLOAT,  -- -1.0 to 1.0
  url TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  INDEX idx_news_symbol_date (symbol, published_at)
)</code></pre>

                    <h4>AI Analyses</h4>
                    <pre><code>ai_analyses (
  id SERIAL PRIMARY KEY,
  symbol VARCHAR(20) NOT NULL,
  analysis_type VARCHAR(50),  -- stock | etf | forex | macro
  signal VARCHAR(10),  -- BUY | HOLD | SELL
  conviction INTEGER,  -- 1-10
  fundamentals_score INTEGER,
  news_score INTEGER,
  price_score INTEGER,
  macro_score INTEGER,
  reasoning TEXT,
  risk_factors TEXT[],
  llm_provider VARCHAR(50),
  execution_time_seconds FLOAT,
  created_at TIMESTAMP DEFAULT NOW(),
  INDEX idx_analyses_symbol_date (symbol, created_at)
)</code></pre>

                    <h3>Indexes</h3>
                    <p>Key indexes for performance optimization:</p>
                    <pre><code>-- Symbol lookups
CREATE INDEX idx_symbols_asset_type ON symbols(asset_type);
CREATE INDEX idx_symbols_sector ON symbols(sector);

-- Price queries
CREATE INDEX idx_prices_symbol_time ON price_history(symbol, time DESC);

-- News queries
CREATE INDEX idx_news_symbol_date ON news_articles(symbol, published_at DESC);
CREATE INDEX idx_news_sentiment ON news_articles(sentiment) WHERE sentiment IS NOT NULL;

-- Portfolio queries
CREATE INDEX idx_positions_portfolio ON positions(portfolio_id);
CREATE INDEX idx_positions_symbol ON positions(symbol);</code></pre>

                    <h3>TimescaleDB Continuous Aggregates</h3>
                    <p>Pre-computed aggregates for common queries:</p>
                    <pre><code>-- Daily OHLCV from intraday data
CREATE MATERIALIZED VIEW daily_prices
WITH (timescaledb.continuous) AS
SELECT
  time_bucket('1 day', time) AS day,
  symbol,
  first(open, time) AS open,
  max(high) AS high,
  min(low) AS low,
  last(close, time) AS close,
  sum(volume) AS volume
FROM price_history
GROUP BY day, symbol;</code></pre>

                    <img src="assets/images/cwf_montecarlo.png" alt="Monte Carlo Simulation" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- OPTIMIZATION STRATEGIES SECTION -->
                <section id="optimization-strategies">
                    <h2>Portfolio Optimization Strategies</h2>

                    <h3>Implementation Details</h3>

                    <h4>1. Mean-Variance Optimization (Markowitz)</h4>
                    <p>Implementation using PyPortfolioOpt:</p>
                    <pre><code>from pypfopt import EfficientFrontier, risk_models, expected_returns

# Calculate expected returns and covariance
mu = expected_returns.mean_historical_return(prices)
S = risk_models.sample_cov(prices)

# Optimize for maximum Sharpe ratio
ef = EfficientFrontier(mu, S)
weights = ef.max_sharpe(risk_free_rate=0.045)
cleaned_weights = ef.clean_weights()

# Get performance metrics
performance = ef.portfolio_performance(risk_free_rate=0.045)
# Returns: (expected_return, volatility, sharpe_ratio)</code></pre>

                    <h4>2. Minimum Variance</h4>
                    <pre><code>ef = EfficientFrontier(mu, S)
weights = ef.min_volatility()
cleaned_weights = ef.clean_weights()

performance = ef.portfolio_performance(risk_free_rate=0.045)</code></pre>

                    <h4>3. Black-Litterman</h4>
                    <pre><code>from pypfopt.black_litterman import BlackLittermanModel

# Market equilibrium
market_caps = get_market_caps(symbols)
market_prices = get_prices(symbols)

# Investor views (optional)
viewdict = {
    "AAPL": 0.20,  # Expect 20% return
    "GOOGL": 0.15
}

# Black-Litterman model
bl = BlackLittermanModel(
    S,
    pi="market",
    market_caps=market_caps,
    risk_aversion=2.5,
    absolute_views=viewdict
)

# Get posterior returns
bl_returns = bl.bl_returns()

# Optimize
ef = EfficientFrontier(bl_returns, S)
weights = ef.max_sharpe(risk_free_rate=0.045)</code></pre>

                    <h3>Constraints</h3>
                    <p>Common constraints applied to all optimizations:</p>
                    <pre><code># Weight bounds
ef.add_constraint(lambda w: w >= 0)  # No shorting
ef.add_constraint(lambda w: w <= 0.30)  # Max 30% per position

# Sector constraints
sector_mapper = get_sector_mapper(symbols)
sector_lower = {sector: 0.05 for sector in sectors}
sector_upper = {sector: 0.40 for sector in sectors}
ef.add_sector_constraints(sector_mapper, sector_lower, sector_upper)</code></pre>

                    <h3>Performance Attribution</h3>
                    <p>Analyze portfolio performance by position:</p>
                    <pre><code>def calculate_attribution(portfolio_weights, returns, benchmark_returns):
    """Calculate performance attribution vs benchmark"""

    # Active weights
    active_weights = portfolio_weights - benchmark_weights

    # Allocation effect
    allocation = active_weights * (benchmark_sector_returns - benchmark_return)

    # Selection effect
    selection = benchmark_weights * (returns - benchmark_sector_returns)

    # Interaction effect
    interaction = active_weights * (returns - benchmark_sector_returns)

    return {
        'allocation': allocation.sum(),
        'selection': selection.sum(),
        'interaction': interaction.sum()
    }</code></pre>

                    <img src="assets/images/cwf_peer_comparison.png" alt="Peer Comparison Analysis" style="max-width: 100%; border-radius: 8px; border: 1px solid #e2e8f0; margin: 2rem 0;">
                </section>

                <!-- RISK ANALYTICS SECTION -->
                <section id="risk-analytics">
                    <h2>Risk Analytics</h2>

                    <h3>Value at Risk (VaR)</h3>
                    <p>Calculate portfolio VaR using historical simulation:</p>
                    <pre><code>def calculate_var(returns, confidence_level=0.95):
    """Calculate Value at Risk"""
    return np.percentile(returns, (1 - confidence_level) * 100)</code></pre>

                    <h3>Conditional Value at Risk (CVaR)</h3>
                    <p>Expected loss beyond VaR threshold:</p>
                    <pre><code>def calculate_cvar(returns, confidence_level=0.95):
    """Calculate Conditional Value at Risk"""
    var = calculate_var(returns, confidence_level)
    return returns[returns <= var].mean()</code></pre>

                    <h3>Monte Carlo Simulation</h3>
                    <p>Simulate future portfolio paths:</p>
                    <pre><code>def monte_carlo_simulation(
    current_value,
    expected_return,
    volatility,
    years,
    simulations=10000
):
    """Run Monte Carlo simulation of portfolio returns"""

    days = years * 252
    dt = 1/252

    # Geometric Brownian Motion
    results = np.zeros((simulations, days))

    for i in range(simulations):
        prices = [current_value]
        for j in range(days):
            drift = (expected_return - 0.5 * volatility**2) * dt
            shock = volatility * np.random.normal() * np.sqrt(dt)
            price = prices[-1] * np.exp(drift + shock)
            prices.append(price)
        results[i] = prices[1:]

    return results</code></pre>

                    <h3>Rolling Sharpe Ratio</h3>
                    <pre><code>def calculate_rolling_sharpe(returns, window=252, risk_free_rate=0.045):
    """Calculate rolling Sharpe ratio"""

    excess_returns = returns - risk_free_rate/252
    rolling_mean = excess_returns.rolling(window).mean()
    rolling_std = excess_returns.rolling(window).std()

    return (rolling_mean / rolling_std) * np.sqrt(252)</code></pre>

                    <h3>Correlation Analysis</h3>
                    <pre><code>def calculate_correlation_matrix(returns):
    """Calculate correlation matrix of returns"""
    return returns.corr()

def find_diversification_opportunities(corr_matrix, threshold=0.3):
    """Find low-correlation pairs for diversification"""

    pairs = []
    for i in range(len(corr_matrix.columns)):
        for j in range(i+1, len(corr_matrix.columns)):
            corr = corr_matrix.iloc[i, j]
            if abs(corr) < threshold:
                pairs.append({
                    'asset1': corr_matrix.columns[i],
                    'asset2': corr_matrix.columns[j],
                    'correlation': corr
                })

    return sorted(pairs, key=lambda x: abs(x['correlation']))</code></pre>

                    <div class="alert warning">
                        <strong>‚ö†Ô∏è Risk Metrics Limitations:</strong> All risk metrics are backward-looking and based on historical data. Past performance and correlations do not guarantee future results.
                    </div>
                </section>

            </div>
        </main>
    </div>

    <footer class="docs-footer">
        <div class="docs-footer-content">
            <p>&copy; 2025 Chat with Fundamentals. All rights reserved.</p>
            <p>
                <a href="https://quantcoder-fs.com">Website</a> ‚Ä¢
                <a href="../contact.html">Contact</a>
            </p>
        </div>
    </footer>
</body>
</html>
